<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Panamove ‚Äì Plataforma Inmobiliaria 7.0</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #020617;
      color: #e5e7eb;
    }
    a { color: inherit; text-decoration: none; }

    .page {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }
   /* HEADER */
header {
  padding: 1.2rem 1.5rem 0.8rem;
  width: 100%;
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 1rem;
}

/* LOGO */
.logo {
  display: flex;
  align-items: center;
  gap: .8rem;
}

.logo-icon {
  width: 38px;
  height: 38px;
  border-radius: 50%;
  background: linear-gradient(135deg, #63e, #5fd, #7af);
}

.logo-text span {
  color: #e5e7eb;
  font-size: 1.15rem;
  font-weight: 600;
}

    .header-actions {
      display: flex;
      gap: .5rem;
      flex-wrap: wrap;
    }
    .chip {
      font-size: .7rem;
      padding: .25rem .7rem;
      border-radius: 999px;
      border: 1px solid #1f2937;
      color: #9ca3af;
    }
    .btn-mini {
      font-size: .75rem;
      padding: .3rem .75rem;
      border-radius: .75rem;
      border: 1px solid #1f2937;
      background: #0b1120;
      cursor: pointer;
    }

    main {
      flex: 1;
      max-width: 1300px;
      margin: 0 auto;
      padding: 0 1.5rem 2rem;
    }
    .page-title {
      margin-bottom: .8rem;
    }
    .page-title h1 {
      font-size: 1.4rem;
      margin-bottom: .2rem;
    }
    .page-title p {
      font-size: .85rem;
      color: #9ca3af;
    }
    .tabs {
      display: flex;
      gap: .4rem;
      margin-bottom: 1rem;
      flex-wrap: wrap;
    }
    .tab {
      font-size: .8rem;
      padding: .45rem .9rem;
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: #020617;
      cursor: pointer;
      color: #cbd5f5;
    }
    .tab.active {
      background: #22c55e;
      color: #022c22;
      border-color: #22c55e;
      font-weight: 600;
    }

    .grid {
      display: grid;
      grid-template-columns: minmax(0, 2.1fr) minmax(0, 2fr);
      gap: 1.5rem;
    }
    @media (max-width: 860px) {
      .grid { grid-template-columns: minmax(0, 1fr); }
    }
    .card {
      background: #020617;
      border-radius: 1rem;
      border: 1px solid #1f2937;
      padding: 1rem 1rem 1.1rem;
      box-shadow: 0 18px 40px -30px rgb(15 23 42 / 0.95);
    }
    .card h2 {
      font-size: 1rem;
      margin-bottom: .25rem;
    }
    .card p {
      font-size: .85rem;
      color: #9ca3af;
      margin-bottom: .6rem;
    }
    .badge-row {
      display: flex;
      flex-wrap: wrap;
      gap: .4rem;
      margin-top: .25rem;
      margin-bottom: .7rem;
    }
    .badge {
      font-size: .7rem;
      padding: .25rem .6rem;
      border-radius: 999px;
      border: 1px solid #1f2937;
      background: #0b1120;
      color: #cbd5f5;
    }

    .section-title {
      font-size: .85rem;
      font-weight: 600;
      margin: .8rem 0 .4rem;
    }

    /* UPLOAD SECTION */
    .upload-section {
      margin-bottom: .6rem;
      margin-top: .4rem;
    }
    .upload-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit,minmax(220px,1fr));
      gap: .9rem;
      margin-top: .35rem;
    }
    .upload-card {
      border-radius: .9rem;
      border: 1px dashed #1f2937;
      background: #020617;
      padding: .8rem .9rem 1rem;
    }
    .upload-card h3 {
      font-size: .9rem;
      margin-bottom: .2rem;
    }
    .upload-card p {
      font-size: .8rem;
      margin-bottom: .6rem;
      color: #cbd5e1;
    }
    .upload-drop {
      border-radius: .7rem;
      border: 1px dashed #334155;
      padding: .55rem .7rem;
      text-align: center;
      font-size: .8rem;
      display: flex;
      flex-direction: column;
      gap: .35rem;
      align-items: center;
      justify-content: center;
      background: #020617;
    }
    .upload-drop.drag-over {
      border-color: #38bdf8;
      background: rgba(15,23,42,.7);
    }
    .upload-btn {
      border-radius: .7rem;
      border: 1px solid #38bdf8;
      padding: .45rem .9rem;
      background: #0b1120;
      color: #e5e7eb;
      font-size: .8rem;
      cursor: pointer;
      white-space: nowrap;
    }
    .upload-actions {
      display: flex;
      flex-wrap: wrap;
      gap: .6rem;
      margin-top: .7rem;
    }
    .upload-view-btn {
      font-size: .78rem;
      padding: .4rem .9rem;
      border-radius: .7rem;
      border: 1px solid #1f2937;
      background: #020617;
      color: #e5e7eb;
      cursor: pointer;
    }

    /* OWNER ACTION PILLS */
    .owner-actions-header {
      display:flex;
      justify-content:space-between;
      align-items:flex-end;
      gap:.5rem;
      margin-top:.6rem;
    }
    .owner-actions-dynamic {
      margin-top:.4rem;
      display:flex;
      flex-direction:column;
      gap:.3rem;
    }
    .owner-pill {
      display:flex;
      align-items:center;
      gap:.4rem;
      border-radius:999px;
      border:1px solid #1f2937;
      background:#020617;
      padding:.3rem .75rem;
      font-size:.8rem;
      color:#e5e7eb;
      max-width:100%;
    }
    .owner-pill-dot {
      width:8px;
      height:8px;
      border-radius:999px;
      background:#22c55e;
      flex-shrink:0;
    }
    .owner-empty {
      font-size:.78rem;
      color:#9ca3af;
    }

    /* RANGE BUTTONS */
    .range-row {
      display:flex;
      flex-wrap:wrap;
      gap:.35rem;
      justify-content:flex-end;
      margin:.3rem 0 .5rem;
    }
    
    /* RANGE BUTTONS */
.range-row {
  display:flex;
  flex-wrap:wrap;
  gap:.35rem;
  justify-content:flex-end;
  margin:.3rem 0 .5rem;
}

/* =============================
   ESPACIADO MEJORADO SERVICIOS
   ============================= */

/* M√°s espacio debajo del t√≠tulo "Servicios disponibles" */
.section-title.servicios-title {
  margin-top: 1.6rem !important;
  margin-bottom: 1.2rem !important;
}

/* M√°s espacio debajo de los rangos num√©ricos */
.range-row.servicios-rangos {
  margin-bottom: 1.3rem !important;
}

/* M√°s espacio vertical entre las tarjetas de servicios */
.services-grid {
  row-gap: 1.4rem !important;
}
    .range-btn {
      font-size:.75rem;
      padding:.25rem .7rem;
      border-radius:999px;
      border:1px solid #1f2937;
      background:#020617;
      color:#cbd5e1;
      cursor:pointer;
    }
    .range-btn-active {
      border-color:#38bdf8;
      background:#0f172a;
      color:#e0f2fe;
    }

    /* SERVICES GRID */
    .services-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: .9rem;
      margin-top: .4rem;
    }
    .service-item {
      font-size: .8rem;
      border-radius: .9rem;
      border: 1px solid #1f2937;
      background: #020617;
      padding: .8rem .9rem .9rem;
      display: flex;
      flex-direction: column;
      gap: .25rem;
    }
    .service-item strong {
      font-size: .9rem;
    }
    .service-meta {
      font-size: .75rem;
      color: #9ca3af;
    }
    .service-btn {
      margin-top:.5rem;
      padding:.4rem .9rem;
      border-radius:.7rem;
      border:1px solid #1f2937;
      background:#0b1120;
      color:#e5e7eb;
      font-size:.78rem;
      cursor:pointer;
      align-self:flex-start;
    }
    /* dorado servicio activado */
    .service-btn-gold {
      border-color:#facc15;
      background: radial-gradient(circle at top, #facc15, #92400e);
      color:#0f172a;
      font-weight:600;
      display:inline-flex;
      align-items:center;
      gap:.35rem;
    }
    .service-btn-gold span.crown {
      font-size:.85rem;
    }
    /* estado done */
    .service-btn-done {
      border-color:#38bdf8;
      background:#0b1120;
      color:#bfdbfe;
      cursor:default;
    }
    /* Bot√≥n dorado especial de FULL ACCIONES */
    .service-btn-full {
      margin-top:.4rem;
      padding:.4rem 1rem;
      border-radius:.8rem;
      border:1px solid #fbbf24;
      background: radial-gradient(circle at top, #facc15, #b45309);
      color:#022c22;
      font-size:.8rem;
      font-weight:700;
      display:inline-flex;
      align-items:center;
      gap:.35rem;
      cursor:pointer;
    }
    .service-btn-full span.crown {
      font-size:.9rem;
    }

    /* KPIS & AUDIT */
    .kpis {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
      gap: .6rem;
      margin-top: .6rem;
    }
    .kpi {
      border-radius: .8rem;
      border: 1px solid #1f2937;
      background: #020617;
      padding: .55rem .6rem;
    }
    .kpi label {
      display: block;
      font-size: .7rem;
      color: #9ca3af;
      margin-bottom: .1rem;
    }
    .kpi span {
      font-size: .9rem;
      font-weight: 600;
    }
    .log {
      font-size: .78rem;
      margin-top: .6rem;
      max-height: 190px;
      overflow-y: auto;
      border-radius: .7rem;
      border: 1px dashed #1f2937;
      padding: .5rem .6rem;
      background: #020617;
    }
    .log-entry {
      margin-bottom: .25rem;
      color: #9ca3af;
    }
    .log-entry strong { color: #e5e7eb; }
    .hint {
      font-size: .75rem;
      color: #9ca3af;
      margin-top: .4rem;
    }

    /* COST BOX */
    .cost-box {
      margin-top:1rem;
      border-radius:.9rem;
      border:1px solid #1f2937;
      background: radial-gradient(circle at top left, rgba(250,204,21,0.16), rgba(15,23,42,0.96));
      padding:.85rem .9rem;
      font-size:.8rem;
    }
    .cost-main-row {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:.5rem;
      margin-bottom:.4rem;
    }
    .cost-label {
      color:#e5e7eb;
      font-weight:500;
    }
    .cost-input {
      min-width: 120px;
      text-align:right;
      padding:.25rem .45rem;
      border-radius:.5rem;
      border:1px solid #1f2937;
      background:#020617;
      color:#e5e7eb;
      font-size:.8rem;
    }
    .cost-line {
      display:flex;
      justify-content:space-between;
      gap:.5rem;
      margin-top:.2rem;
    }
    .cost-line-label {
      color:#cbd5e1;
    }
    .cost-line-value {
      font-variant-numeric:tabular-nums;
      color:#facc15;
    }
    .cost-net {
      margin-top:.5rem;
      padding-top:.4rem;
      border-top:1px dashed #4b5563;
      font-weight:600;
    }
    .cost-note {
      font-size:.75rem;
      color:#9ca3af;
      margin-top:.45rem;
    }

    footer {
      font-size: .7rem;
      color: #6b7280;
      padding: .75rem 1.5rem 1.3rem;
      max-width: 1100px;
      margin: 0 auto;
    }

    .agency-actions {
      margin-top: .8rem;
      border-top: 1px solid #1f2937;
      padding-top: .6rem;
    }
    .agency-actions p {
      margin-bottom: .4rem;
      font-size:.8rem;
      color:#9ca3af;
    }
    .agency-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(170px,1fr));
      gap:.5rem;
    }
    .agency-btn {
      margin-top:.35rem;
      font-size:.72rem;
      padding:.3rem .6rem;
      border-radius:.6rem;
      border:1px solid #1d4ed8;
      background:#020617;
      color:#bfdbfe;
      cursor:pointer;
    }
    .agency-btn:disabled {
      opacity:.7;
      cursor:default;
    }

    /* MODAL */
    .modal-backdrop {
      position:fixed;
      inset:0;
      background:rgba(15,23,42,.8);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:40;
    }
    .modal-card {
      background:#020617;
      border-radius:1rem;
      border:1px solid #1f2937;
      max-width:780px;
      width:92%;
      max-height:80vh;
      padding:1rem 1.1rem 1.2rem;
      display:flex;
      flex-direction:column;
      gap:.5rem;
      box-shadow:0 30px 80px -40px rgb(15 23 42 / .9);
    }
    .modal-header {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:.5rem;
    }
    .modal-title {
      font-size:.9rem;
      font-weight:600;
    }
    .modal-close {
      font-size:.8rem;
      padding:.25rem .7rem;
      border-radius:.6rem;
      border:1px solid #1f2937;
      background:#020617;
      color:#e5e7eb;
      cursor:pointer;
    }
    .modal-body {
      margin-top:.3rem;
      overflow:auto;
      padding-right:.2rem;
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
      gap:.5rem;
    }
    .modal-empty {
      font-size:.8rem;
      color:#9ca3af;
    }
    .modal-item {
  border-radius:.7rem;
  border:1px solid #1f2937;
  padding:.6rem .7rem .7rem;
  background:#020617;
  display:flex;
  flex-direction:column;
  align-items:center;
  gap:.4rem;
  text-align:center;
}

/* Mini tarjeta seleccionable */
.modal-item.selected {
  border-color:#38bdf8;
  box-shadow:0 0 0 1px rgba(56,189,248,0.4);
}

/* La preview se ve m√°s grande y limpia */
.modal-item img {
  width:100%;
  max-width:260px;
  height:160px;
  object-fit:contain;
  background:#020617;
  border-radius:.55rem;
  cursor:pointer;
}

    .modal-item-name {
      font-size:.75rem;
      color:#e5e7eb;
      word-break:break-word;
    }
       .modal-delete {
      align-self:flex-end;
      font-size:.7rem;
      padding:.2rem .55rem;
      border-radius:.6rem;
      border:1px solid #b91c1c;
      background:#450a0a;
      color:#fecaca;
      cursor:pointer;
    }

    /* =========================
       RESPONSIVE ‚Äì MODO APP M√ìVIL
       ========================== */

    /* Tablets y pantallas medianas */
    @media (max-width: 1024px) {
      header {
        padding: 0.8rem 1rem 0.6rem;
      }

      main {
        padding: 0 1rem 1.5rem;
      }
    }

    /* M√≥viles (modo app) */
@media (max-width: 768px) {

  body {
    font-size: 15px;
  }

  /* HEADER: logo claro + bot√≥n a la derecha */
  header {
    max-width: 100%;
    padding: 0.7rem 0.9rem 0.4rem;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 0.6rem;
    flex-wrap: nowrap;
  }

  .logo-icon {
    width: 30px;
    height: 30px;
  }

  /* Logo en dos l√≠neas para que no se monte */
  .logo-text {
    display: flex;
    flex-direction: column;
    line-height: 1.15;
  }
  .logo-text span:first-child {
    font-size: 0.9rem;
    font-weight: 600;
  }
  .logo-text span:last-child {
    font-size: 0.78rem;
    font-weight: 500;
  }

  .header-actions {
    margin-left: auto;
    flex-shrink: 0;
  }

  .btn-mini {
    font-size: 0.72rem;
    padding: 0.3rem 0.7rem;
  }

  /* T√≠tulo y subt√≠tulo */
  .page-title {
    margin: 0.4rem 0 0.6rem;
  }
  .page-title h1 {
    font-size: 1.05rem;
    line-height: 1.3;
  }
  .page-title p {
    font-size: 0.8rem;
  }

  main {
    padding: 0 0.9rem 1.2rem;
  }

  /* Tabs tipo app: scroll horizontal */
  .tabs {
    margin-bottom: 0.8rem;
    overflow-x: auto;
    white-space: nowrap;
    padding-bottom: 0.2rem;
  }
  .tab {
    flex: 0 0 auto;
    font-size: 0.8rem;
    padding: 0.4rem 0.8rem;
  }

  /* Layout en una columna */
  .grid {
    grid-template-columns: minmax(0, 1fr);
    gap: 1rem;
  }

  .card {
    padding: 0.9rem 0.85rem 1rem;
    border-radius: 0.9rem;
  }

  /* Chips y badges */
  .badge-row {
    gap: 0.35rem;
  }
  .badge {
    font-size: 0.7rem;
    padding: 0.25rem 0.55rem;
  }

  /* Subida de archivos: una sola columna */
  .upload-grid {
    grid-template-columns: minmax(0, 1fr);
    gap: 0.9rem;
  }

  .upload-card {
    padding: 0.75rem 0.8rem 0.9rem;
  }

  .upload-drop {
    padding: 0.5rem 0.6rem;
  }

  .upload-actions {
    flex-direction: column;
    align-items: stretch;
  }

  .upload-view-btn {
    width: 100%;
    text-align: center;
  }

  /* Rangos alineados a la izquierda */
  .range-row {
    justify-content: flex-start;
    gap: 0.3rem;
  }

  .range-btn {
    font-size: 0.72rem;
    padding: 0.22rem 0.6rem;
  }

  /* Servicios en una columna tipo app */
  .services-grid {
    grid-template-columns: minmax(0, 1fr);
    gap: 0.8rem;
  }

  .service-item {
    padding: 0.75rem 0.85rem 0.9rem;
  }

  .service-btn,
  .service-btn-full {
    width: 100%;
    justify-content: center;
    text-align: center;
  }

  /* Acciones propietario */
  .owner-actions-dynamic {
    gap: 0.25rem;
  }

  .owner-pill {
    font-size: 0.78rem;
  }

  /* KPIs en 2 columnas */
  .kpis {
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 0.5rem;
  }

  .kpi {
    padding: 0.5rem 0.55rem;
  }

  /* Caja econ√≥mica: vertical */
  .cost-box {
    margin-top: 0.8rem;
  }

  .cost-main-row {
    flex-direction: column;
    align-items: flex-start;
    gap: 0.4rem;
  }

  .cost-input {
    width: 100%;
    text-align: left;
    font-size: 0.85rem;
  }

  .cost-line {
    font-size: 0.8rem;
  }

  .cost-note {
    font-size: 0.72rem;
  }

   /* Log de auditor√≠a algo m√°s compacto */
  .log {
    max-height: 160px;
    font-size: 0.76rem;
  }

  /* Footer m√°s peque√±o */
   footer {
    padding: 0.6rem 0.9rem 1rem;
    font-size: 0.7rem;
  }

   /* M√≥viles muy peque√±os: KPIs en 1 columna */
  @media (max-width: 480px) {
    .kpis {
      grid-template-columns: minmax(0, 1fr);
    }
  }
} /* ‚Üê cierre del @media (max-width: 768px) */

  /* Espacio extra antes de "Subir fotos y documentaci√≥n" */
  .upload-section {
    margin-top: 1.2rem;
  }

  /* M√°s aire antes de "Servicios disponibles" (si la usas en otros sitios) */
  .servicios-title {
    margin-top: 1.6rem;
  }

  /* ============================================
     REJILLA SUPERIOR: CONTENIDO + CAJA DE COSTES
     ============================================ */

  .prop-top-grid {
    display: grid;
    grid-template-columns: minmax(0, 2.2fr) minmax(0, 1.5fr);
    gap: 1.2rem;
    align-items: flex-start;
    margin-bottom: 1.2rem;
  }

  .prop-main {
    min-width: 0;
  }

    .prop-cost .cost-box {
    margin-top: 0;   /* sin margen extra dentro de la rejilla */
  }

  @media (max-width: 1024px) {
    .prop-top-grid {
      grid-template-columns: minmax(0, 1fr);
    }
  }
/* ============================================
   CAJA DE COSTES ‚Äì CORRECCI√ìN DE ANCHO
   ============================================ */

.prop-cost {
  min-width: 0;                   /* Permite que el contenido se reduzca sin romper layout */
}

.cost-box {
  width: 100%;                    /* Que ocupe toda su columna */
  max-width: 440px;               /* üî• Ancho ideal sin salirse del panel */
  box-sizing: border-box;
  margin-left: auto;              /* La empuja a la derecha dentro de su celda */
  margin-top: 0;
  border-radius: 18px;
}

/* El input no debe empujar el resto del contenido */
.cost-input {
  min-width: 220px;
  max-width: 100%;
  font-size: 0.85rem;
  padding: 0.3rem 0.65rem;
}

/* Tipograf√≠a interna optimizada */
.cost-box .cost-main-row,
.cost-box .cost-line,
.cost-box .cost-note {
  font-size: 0.88rem;
  line-height: 1.35;
}

/* üî• En pantallas medianas/mobiles la caja baja y ocupa todo el ancho */
@media (max-width: 1024px) {
  .cost-box {
    max-width: 100%;
    margin-left: 0;
  }
}
  /* ============================================
     BLOQUE ACCIONES + SERVICIOS ‚Äì DISE√ëO EN CAJA
     ============================================ */

  /* Caja gen√©rica para los rangos */
  .range-card {
    background: rgba(15, 23, 42, 0.98);
    border: 1px solid #1f2937;
    border-radius: 1rem;
    padding: 1rem 1.3rem 1.1rem;
    box-shadow: 0 10px 30px -18px rgba(0, 0, 0, 0.6);
  }

  /* Caja superior: "Acciones activadas por el propietario" */
  .range-card-owner {
    margin-top: 2rem;
    margin-bottom: 1.6rem;
  }

  /* Caja inferior: "Servicios disponibles" */
  .range-card-services {
    margin-top: 2rem;
    margin-bottom: 2rem;
  }

  /* T√≠tulo dentro de las cajas */
  .range-card .titulo-principal {
    margin: 0 0 0.8rem;
    font-size: 1.15rem;
    font-weight: 700;
    color: #67b8f7;  /* mismo azul que el bot√≥n "Soy propietario" */
  }

  /* Fila de rangos dentro de las cajas: alineado a la izquierda y con m√°s aire */
  .range-card .range-row {
    display: flex;
    flex-wrap: wrap;
    gap: 0.55rem;
    margin: 0;
    justify-content: flex-start;
  }

  /* Un poco m√°s de aire entre el t√≠tulo y las p√≠ldoras verdes */
  .owner-actions-dynamic {
    margin-top: 0.8rem;
  }

  /* P√≠ldoras verdes algo m√°s ‚Äúcaja‚Äù */
  .owner-pill {
    border-radius: 0.9rem;
    padding: 0.35rem 0.9rem;
  }

  /* M√°s espacio vertical entre las tarjetas de servicios */
  .services-grid {
    margin-top: 1.1rem;
    row-gap: 1.4rem;
  }

  /* ===============================
     TIPOGRAF√çAS EQUILIBRADAS
     =============================== */

  body, p, label {
    font-size: 0.90rem;
    line-height: 1.45;
  }

  .titulo-principal {
    color: #67b8f7;
    font-size: 1.05rem;
    font-weight: 700;
    margin-bottom: 0.6rem;
  }

  .section-title {
    font-size: 0.95rem;
    margin-bottom: 0.6rem;
  }

  /* ===============================
     CAJAS M√ÅS ELEGANTES Y CON AIRE
     =============================== */

  .box {
    padding: 1rem 1.2rem;          
    border-radius: 12px;
    background: #ffffff;
    border: 1px solid #e6e6e6;
    box-shadow: 0 2px 6px rgba(0,0,0,0.06);
    margin-bottom: 1.1rem;
  }

  /* Separaci√≥n entre secciones */
  .section {
    margin-bottom: 2rem;
  }

  /* ===============================
     INPUTS M√ÅS PROFESIONALES
     =============================== */

  input, select, textarea {
    padding: 0.55rem 0.7rem;
    font-size: 0.9rem;
    border-radius: 8px;
    border: 1px solid #d4d4d4;
    transition: 0.25s;
  }

  input:focus, select:focus, textarea:focus {
    border-color: #67b8f7;
    box-shadow: 0 0 0 3px rgba(103,184,247,0.25);
  }

  /* ===============================
     KPIs CON M√ÅS AIRE
     =============================== */

  .kpis {
    display: grid;
    gap: 1rem;
  }

  .kpi-box {
    padding: 1rem;
    border-radius: 14px;
    border: 1px solid #e1e1e1;
    background: #fafafa;
    text-align: center;
  }

  /* ===============================
     RESPONSIVE
     =============================== */

  @media (max-width: 480px) {
    .box {
      padding: 0.85rem 1rem;
    }

    .titulo-principal {
      font-size: 1rem;
    }

    .section-title {
      font-size: 0.9rem;
    }

    body, p, label {
      font-size: 0.85rem;
    }

    .kpis {
      grid-template-columns: 1fr;
    }
  }
 

/* ============================================
   PANEL PRINCIPAL M√ÅS ANCHO Y ELEGANTE
   ============================================ */
.panel .card {
  max-width: 1150px !important;     /* m√°s ancho */
  margin: 2.8rem auto !important;   /* baja el panel y respira */
  padding: 2.3rem 2.6rem !important; /* m√°s aire interno */
  border-radius: 18px !important;
  background: #0b1120 !important;   /* tono premium */
  border: 1px solid rgba(148, 163, 184, 0.40) !important;
  box-shadow: 0 22px 55px -22px rgba(0,0,0,0.85) !important;
}


/* Texto dentro de la tarjeta principal algo m√°s peque√±o */
.panel .card p {
  font-size: 0.86rem;
  line-height: 1.55;
  margin-bottom: 0.45rem;
}

/* Encabezados dentro de la tarjeta m√°s contenidos */
.panel .card h1,
.panel .card h2,
.panel .card h3 {
  margin-top: 0;
  margin-bottom: 0.5rem;
}

.panel .card h2.titulo-principal {
  font-size: 0.98rem;    /* baja un poco el impacto del t√≠tulo del √°tico */
}

/* ============================================
   AJUSTE VISUAL Cajas oscuras (acciones/servicios)
   ============================================ */

/* ============================================
   CAJAS OSCURAS: ACCIONES / SERVICIOS
   ============================================ */

.range-card {
  padding: 1.6rem 1.8rem 1.7rem;           /* m√°s aire todav√≠a */
  border-radius: 18px;
  background: rgba(15, 23, 42, 0.96);
  border: 1px solid rgba(30, 64, 175, 0.55);
}

/* Texto interno m√°s peque√±o y elegante */
.range-card p {
  font-size: 0.8rem;
  line-height: 1.55;
  margin-bottom: 0.38rem;
}

/* P√≠ldoras y rangos con m√°s espacio entre ellos */
.range-card .range-row {
  gap: 0.8rem;
  margin-top: 0.7rem;
}

/* Un poco m√°s de espacio entre t√≠tulo y l√≠nea de acciones */
.owner-actions-dynamic {
  margin-top: 1.1rem;
}

/* P√≠ldoras m√°s peque√±as y menos ‚Äúbloque‚Äù */
.owner-pill {
  font-size: 0.78rem;
  padding: 0.3rem 0.85rem;
}

/* Servicios: m√°s aire entre cada bloque */
.services-grid {
  margin-top: 1.6rem;
  row-gap: 1.9rem;
}

/* Cada servicio dentro de la rejilla con m√°s padding interno */
.services-grid > div {
  padding: 1.1rem 1.3rem;
}



/* ============================================
   M√ÅS AIRE EN LAS P√çLDORAS DE RANGOS (1‚Äì4, 5‚Äì8‚Ä¶)
   ============================================ */

.prop-actions,
.prop-services {
  margin-top: 1.6rem;
  margin-bottom: 2rem;
}

.range-row,
.filters-row,
.range-selector {
  display: flex;
  flex-wrap: wrap;
  gap: 0.8rem !important;      /* m√°s aire entre p√≠ldoras */
  margin-top: 0.75rem !important; 
  margin-bottom: 0.75rem !important;
}

/* Las p√≠ldoras en s√≠ mismas m√°s peque√±as y estilizadas */
.range-pill,
.filter-pill,
.range-selector button {
  padding: 0.35rem 0.9rem !important;
  font-size: 0.78rem !important;
  border-radius: 0.9rem !important;
  line-height: 1;
}

/* Un poco m√°s de espacio entre el t√≠tulo y las p√≠ldoras */
.prop-actions h3,
.prop-services h3 {
  margin-bottom: 0.6rem !important;
}

/* ============================================
   PANEL PRINCIPAL M√ÅS ANCHO
   ============================================ */

.panel .card {
  max-width: 1150px !important;
  padding: 2rem 2.3rem !important;
  margin-top: 2.5rem !important;
}

/* M√°s separaci√≥n entre bloques Acciones / Servicios */
.prop-actions,
.prop-services {
  margin-top: 2.5rem !important;
  margin-bottom: 2.5rem !important;
}

/* ============================================
   CAJAS DE SERVICIOS: ESTILO PREMIUM
   ============================================ */

.services-grid {
  margin-top: 2rem !important;
  display: grid;
  grid-template-columns: repeat(2, minmax(0, 1fr));
  column-gap: 2.5rem !important;
  row-gap: 2.5rem !important;
}

/* Cada servicio como caja amplia */
.services-grid .service-item {
  padding: 1.9rem 2.2rem !important;
  border-radius: 18px !important;
  border: 1px solid rgba(148, 163, 184, 0.35) !important;
  background: rgba(20, 27, 45, 0.96) !important;
  box-shadow: 0 12px 36px -12px rgba(0, 0, 0, 0.45);
  transition: 0.3s;
}

.services-grid .service-item:hover {
  transform: translateY(-3px);
  box-shadow: 0 16px 42px -10px rgba(0, 0, 0, 0.55);
}

/* T√≠tulo de cada servicio (el <strong>) */
.services-grid .service-item strong {
  display: block;
  font-size: 0.98rem !important;
  margin-bottom: 0.5rem !important;
}

/* L√≠neas de detalle (class="service-meta") */
.services-grid .service-meta {
  font-size: 0.8rem !important;
  line-height: 1.5 !important;
  color: #d1d5db !important;
  margin-bottom: 0.25rem !important;
}

/* Bot√≥n de servicio */
.services-grid .service-btn {
  margin-top: 1rem !important;
  padding: 0.55rem 0.9rem !important;
  border-radius: 10px !important;
  font-size: 0.85rem !important;
}

/* M√°s aire en las p√≠ldoras de rangos 1‚Äì4, 5‚Äì8‚Ä¶ */
.range-row {
  display: flex;
  flex-wrap: wrap;
  gap: 0.8rem !important;
  margin-top: 0.75rem !important;
  margin-bottom: 0.75rem !important;
}

.range-btn {
  padding: 0.35rem 0.9rem !important;
  font-size: 0.78rem !important;
  border-radius: 0.9rem !important;
  line-height: 1;
}

/* Un poco m√°s de aire debajo del bloque de servicios */
.prop-services {
  margin-bottom: 3.2rem !important;
}

/* El texto final de explicaci√≥n separado del bloque */
.prop-services + p {
  margin-top: 1.5rem;
  margin-bottom: 0.5rem;
}
/* ============================================
   BLOQUE ACCIONES / SERVICIOS M√ÅS PROFESIONAL
   ============================================ */

/* M√°s aire por encima y por debajo de cada caja oscura */
.range-card {
  margin-top: 2rem !important;
  margin-bottom: 1.2rem !important;
}

/* Entre "Acciones activadas" y "Servicios disponibles" todav√≠a m√°s espacio */
.range-card + .range-card {
  margin-top: 2.6rem !important;
}

/* T√≠tulo m√°s elegante y con aire debajo */
.range-card .titulo-principal {
  font-size: 1.05rem !important;
  letter-spacing: 0.01em;
  margin-bottom: 1rem !important;
}

/* P√≠ldoras alineadas a la izquierda y m√°s limpias */
.range-card .range-row {
  justify-content: flex-start !important;
  gap: 0.7rem !important;
}

/* P√≠ldoras m√°s finas y elegantes */
.range-btn {
  padding: 0.32rem 0.95rem !important;
  font-size: 0.78rem !important;
  border-radius: 999px !important;
  border-width: 1px !important;
}
/* ============================================
   ESPACIADO PRO ENTRE ACCIONES / SERVICIOS
   ============================================ */

/* Caja "Acciones activadas por el propietario" */
.panel .card > .range-card:first-of-type {
  margin-top: 2.2rem !important;      /* baja un poco el bloque entero */
  margin-bottom: 0.8rem !important;
}

/* Lista din√°mica de acciones (texto que aparece debajo) */
.panel .card > #owner-actions-dynamic {
  margin-top: 0.6rem !important;
  margin-bottom: 2.0rem !important;   /* separa bien de "Servicios disponibles" */
}

/* Caja "Servicios disponibles (tarifas ejemplo)" */
.panel .card > .range-card:nth-of-type(2) {
  margin-top: 0 !important;           /* ya la bajamos con el bloque anterior */
  margin-bottom: 1.4rem !important;
}

/* √öltimo texto bajo los servicios: "El propietario ve esto como panel de mando..." */
.panel .card > p:last-of-type {
  margin-top: 1.8rem !important;
  margin-bottom: 0.4rem !important;
  font-size: 0.78rem;
  color: #9ca3af;
}

/* P√≠ldoras de rangos un poco m√°s suaves y limpias dentro del panel */
.panel .card .range-row {
  justify-content: flex-start !important;
  gap: 0.7rem !important;
  margin-top: 0.45rem !important;
  margin-bottom: 0.7rem !important;
}

.panel .card .range-btn {
  padding: 0.3rem 0.95rem !important;
  font-size: 0.78rem !important;
  border-radius: 999px !important;
  border-width: 1px !important;
}
/* ============================================
   AIRE ENTRE COSTES / ACCIONES / SERVICIOS
   ============================================ */

/* M√°s espacio debajo de la caja de costes y antes de "Acciones activadas" */
.cost-box {
  margin-bottom: 2.2rem !important;
}

/* M√°s espacio entre "Acciones activadas..." y "Servicios disponibles..." */
#owner-actions-dynamic {
  margin-bottom: 2.4rem !important;
}

/* P√≠ldoras algo m√°s finas para que respiren mejor visualmente */
.range-row {
  justify-content: flex-start !important;
  gap: 0.7rem !important;
  margin-top: 0.55rem !important;
  margin-bottom: 0.75rem !important;
}

.range-btn {
  padding: 0.3rem 0.95rem !important;
  font-size: 0.78rem !important;
  border-radius: 999px !important;
}
/* ============================================
   ESPACIO REAL ENTRE LAS SECCIONES ACTUALES
   ============================================ */

/* 1Ô∏è‚É£ M√ÅS ESPACIO ENTRE LA CAJA DORADA Y ‚ÄúACCIONES ACTIVADAS‚Äù */
.cost-box {
  margin-bottom: 2.8rem !important;
}

/* 2Ô∏è‚É£ M√ÅS ESPACIO ENTRE ‚ÄúACCIONES ACTIVADAS‚Äù Y LA SIGUIENTE CAJA OSCURA */
#owner-actions-dynamic {
  margin-bottom: 2.8rem !important;
}

/* 3Ô∏è‚É£ M√ÅS ESPACIO ENTRE LA PRIMERA .range-card Y LA SEGUNDA */
.range-card + #owner-actions-dynamic + .range-card {
  margin-top: 3rem !important;
}

/* 4Ô∏è‚É£ P√çLDORAS M√ÅS PROFESIONALES */
.range-row {
  justify-content: flex-start !important;
  gap: 0.9rem !important;
  margin-top: 0.9rem !important;
  margin-bottom: 1.4rem !important;
}

.range-btn {
  padding: 0.42rem 1.2rem !important;
  font-size: 0.79rem !important;
  border-radius: 999px !important;
}
/* ============================================
   FIX 1 ¬∑ Caja de precio m√°s ancha y ordenada
   ============================================ */

/* Darle m√°s columna a la caja de precio */
.prop-top-grid {
  grid-template-columns: minmax(0, 2.1fr) minmax(0, 1.9fr);
  align-items: flex-start;
}

/* Caja de precio con algo menos de padding y texto un poco m√°s peque√±o */
.cost-box {
  padding: 1rem 1.1rem;
}

.cost-label {
  font-size: 0.82rem;
}

.cost-input {
  font-size: 0.8rem;
}

.cost-line {
  font-size: 0.78rem;
}

.cost-note {
  font-size: 0.74rem;
}



/* ============================================
   FIX 2 ¬∑ Botones "Servicio activado" m√°s finos
   ============================================ */

/* Reducir tama√±o del bot√≥n dorado */
.service-btn-gold {
  padding: 0.4rem 1rem;
  font-size: 0.8rem;
  border-radius: 0.8rem;
}

/* Las cajas de servicio un poco menos ‚Äútochas‚Äù */
.services-grid .service-item {
  padding: 1.4rem 1.6rem !important;
}
/* ============================================
   AJUSTE CAJA DE PRECIO (m√°s grande y legible)
   ============================================ */

.prop-top-grid {
  grid-template-columns: minmax(0, 1.9fr) minmax(0, 1.3fr) !important;
}

.prop-cost .cost-box {
  padding: 1.15rem 1.25rem 1.25rem !important;
  font-size: 0.8rem !important;
}

.cost-main-row {
  align-items: flex-start !important;
}

.cost-line-label,
.cost-line-value {
  font-size: 0.78rem !important;
}

/* ============================================
   BOTONES DORADOS M√ÅS PEQUE√ëOS
   ============================================ */

.service-btn-gold {
  padding: 0.35rem 1.1rem !important;
  border-radius: 999px !important;
  font-size: 0.8rem !important;
  min-width: auto !important;
  display: inline-flex !important;
  align-items: center;
  justify-content: center;
}

/* icono corona m√°s discreto */
.service-btn-gold .crown {
  font-size: 0.85rem !important;
  margin-right: 0.25rem;
}
/* ============================================
   AJUSTE ANCHO CAJA DE PRECIO
   ============================================ */

/* M√°s ancho para la columna derecha (precio) */
.prop-top-grid {
  grid-template-columns: minmax(0, 1.6fr) minmax(380px, 1.7fr);
}

/* La caja de precio nunca ser√° m√°s estrecha de 380px */
.prop-cost .cost-box {
  min-width: 380px;
}

/* Bot√≥n / input de "Introduce el precio" m√°s contenido */
.cost-main-row input,
.cost-main-row button {
  font-size: 0.78rem;
  padding: 0.25rem 0.7rem;
}

/* ============================================
   BOTONES DORADOS M√ÅS PEQUE√ëOS
   ============================================ */

.service-btn-gold {
  padding: 0.35rem 0.9rem;      /* menos alto y menos ancho */
  font-size: 0.82rem;           /* texto un poco m√°s peque√±o */
  border-radius: 0.8rem;
}

.service-btn-gold span.crown {
  font-size: 0.8rem;            /* corona m√°s discreta */
}
/* ================================
   AJUSTE ANCHO CAJA DE PRECIO
   ================================ */
.prop-cost .cost-box {
  width: 360px !important;        /* antes era 300‚Äì320px, ahora cabe todo */
  padding: 1.2rem 1.4rem !important;  /* m√°s aire lateral */
}

/* Evitar que las l√≠neas largas se monten */
.prop-cost .cost-line-label {
  white-space: normal !important; 
  line-height: 1.35 !important;
}
/* ============================================
   AJUSTE CAJA PRECIO + ANCHOS
   ============================================ */

/* La rejilla superior: m√°s espacio para la columna del precio */
.prop-top-grid {
  grid-template-columns: minmax(0, 1.9fr) minmax(0, 1.7fr);
  column-gap: 1.5rem;
}

/* Evitar que la columna derecha ‚Äúempuje‚Äù fuera del panel */
.prop-cost {
  min-width: 0;
}

/* La caja dorada de precio: ancho controlado y dentro del panel */
.cost-box {
  max-width: 380px;
  width: 100%;
  box-sizing: border-box;
}

/* Etiquetas de las l√≠neas un pel√≠n m√°s compactas y con buen salto de l√≠nea */
.cost-line {
  align-items: flex-start;
}

.cost-line-label,
.cost-line-value {
  white-space: normal;
  line-height: 1.35;
  font-size: 0.80rem;
}

/* En pantallas medias/peque√±as todo en una columna sin desbordarse */
@media (max-width: 1024px) {
  .prop-top-grid {
    grid-template-columns: minmax(0, 1fr);
  }
  .cost-box {
    max-width: none;
  }
}

/* ============================================
   BOT√ìN DORADO "SERVICIO ACTIVADO" M√ÅS DISCRETO
   ============================================ */

.service-btn-gold {
  padding: 0.4rem 1.0rem !important;
  font-size: 0.8rem !important;
  border-radius: 0.75rem !important;
}
/* ============================================
   ARREGLO CAJA DE PRECIO (ANCHO + DESBORDES)
   ============================================ */

/* El panel no deja que nada se salga hacia la derecha */
.panel .card {
  overflow: hidden;                      /* corta cualquier cosa que se desborde */
}

/* Repartimos mejor el espacio entre columnas */
.prop-top-grid {
  grid-template-columns: minmax(0, 1.7fr) minmax(0, 1.9fr);  /* m√°s ancho para la caja de precio */
  column-gap: 1.6rem;
}

.prop-cost {
  min-width: 0;
}

/* Caja de precio m√°s ancha y contenida */
.cost-box {
  max-width: 430px;      /* antes era m√°s estrecha */
  width: 100%;
  box-sizing: border-box;
}

/* Cada l√≠nea de coste puede romper en varias l√≠neas sin salirse */
.cost-line {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  column-gap: 0.75rem;
  flex-wrap: wrap;       /* permite salto de l√≠nea en textos largos */
}

.cost-line-label,
.cost-line-value {
  white-space: normal;   /* SIN nowrap: que el texto pueda bajar a la siguiente l√≠nea */
  font-size: 0.80rem;
  line-height: 1.35;
}

/* El input "Introduce el precio" puede bajar debajo del t√≠tulo si no cabe */
.cost-main-row {
  flex-wrap: wrap;
  gap: 0.4rem 0.75rem;
}

.cost-input {
  width: 190px;
}

/* En pantallas medianas/peque√±as, todo a una columna y sin problemas de ancho */
@media (max-width: 1024px) {
  .prop-top-grid {
    grid-template-columns: minmax(0, 1fr);
  }
  .cost-box {
    max-width: none;
  }
}
/* ============================================
   FIX CAJA DE COSTES (que no se salga)
   ============================================ */

/* Rejilla superior: un poco m√°s de ancho para la caja de costes */
.prop-top-grid {
  display: grid;
  grid-template-columns: minmax(0, 1.9fr) minmax(0, 1.7fr);
  gap: 1.8rem;
  align-items: flex-start;
  margin-bottom: 1.4rem;
}

/* La columna de costes puede encoger */
.prop-cost {
  min-width: 0;
}

/* La caja de costes ocupa SOLO su columna, sin desbordar */
.prop-cost .cost-box {
  width: 100%;
  max-width: 100%;     /* anula el max-width anterior */
  margin: 0;           /* fuera el margin-left:auto que la empuja rara */
  box-sizing: border-box;
}

/* Fila "Precio de la propiedad" + input: que pueda romper l√≠nea */
.cost-main-row {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 0.6rem;
  flex-wrap: wrap;     /* üî• CLAVE: permite que baje el input si no cabe */
}

/* El texto puede ocupar varias l√≠neas */
.cost-label {
  flex: 1 1 auto;
}

/* El input ya no fuerza la caja a crecer */
.cost-input {
  flex: 0 0 auto;
  min-width: 210px;
  max-width: 100%;
  font-size: 0.84rem;
  padding: 0.28rem 0.65rem;
}

/* En pantallas medianas/peque√±as la caja baja y el input se pone debajo */
@media (max-width: 1024px) {
  .prop-top-grid {
    grid-template-columns: minmax(0, 1fr);
  }

  .cost-main-row {
    flex-direction: column;
    align-items: flex-start;
  }

  .cost-input {
    width: 100%;
    text-align: left;
  }
}

/* ============================================
   BOT√ìN "SERVICIO ACTIVADO" M√ÅS DISCRETO
   ============================================ */

.service-btn-gold {
  padding: 0.45rem 1.1rem;
  border-radius: 0.7rem;
  font-size: 0.82rem;
}
/* ============================================
   ARREGLO DEFINITIVO CAJA DE COSTES
   ============================================ */

/* La rejilla superior: columna izquierda flexible + columna derecha fija */
.prop-top-grid {
  display: grid;
  grid-template-columns: minmax(0, 1.7fr) minmax(0, 360px); /* 360px para que quepa todo el texto */
  column-gap: 1.8rem;
  align-items: flex-start;
}

/* Columna de la derecha limitada y contenida */
.prop-cost {
  max-width: 360px;
  width: 100%;
  min-width: 0;
}

/* La caja de costes ocupa el 100% de su columna, sin salirse */
.prop-cost .cost-box {
  width: 100% !important;
  max-width: 100% !important;
  margin: 0 !important;
  box-sizing: border-box;
}

/* Fila del t√≠tulo + input: puede partir en dos l√≠neas si hace falta */
.cost-main-row {
  display: flex;
  flex-wrap: wrap;              /* üî• permite romper l√≠nea */
  justify-content: space-between;
  align-items: flex-start;
  gap: 0.6rem;
}

.cost-label {
  flex: 1 1 auto;
}

/* El input no fuerza a crecer la caja */
.cost-input {
  flex: 0 0 auto;
  min-width: 210px;
  max-width: 100%;
  font-size: 0.84rem;
  padding: 0.28rem 0.65rem;
}

/* En pantallas medianas/peque√±as, todo en columna */
@media (max-width: 1024px) {
  .prop-top-grid {
    grid-template-columns: minmax(0, 1fr);
  }

  .prop-cost {
    max-width: 100%;
  }

  .cost-main-row {
    flex-direction: column;
    align-items: flex-start;
  }

  .cost-input {
    width: 100%;
    text-align: left;
  }
}
/* ============================================
   FIX DEFINITIVO CAJA DE COSTES + BOT√ìN DORADO
   (sobrescribe todo lo anterior)
   ============================================ */

/* El panel nunca deja que nada se salga hacia la derecha */
.panel .card {
  overflow: hidden;
}

/* Rejilla superior: texto + caja de costes */
.prop-top-grid {
  display: grid;
  grid-template-columns: minmax(0, 1.7fr) minmax(0, 1.5fr);
  gap: 1.4rem;
  align-items: flex-start;
  margin-bottom: 1.3rem;
}

/* Que ambas columnas puedan encoger sin romper nada */
.prop-main,
.prop-cost {
  min-width: 0;
}

/* Caja de costes: siempre dentro de su columna */
.cost-box {
  width: 100%;
  max-width: 100%;
  box-sizing: border-box;
  margin: 0;
}

/* Fila "Precio de la propiedad" + input */
.cost-main-row {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 0.7rem;
  margin-bottom: 0.6rem;
}

/* Input: tama√±o contenido, pero sin empujar la caja */
.cost-input {
  flex: 0 0 auto;
  min-width: 210px;
  max-width: 45%;
  font-size: 0.84rem;
  padding: 0.28rem 0.65rem;
  text-align: right;
}

/* En pantallas medianas/peque√±as, todo en una columna
   (la caja baja y JAM√ÅS se sale del cuerpo) */
@media (max-width: 1024px) {
  .prop-top-grid {
    grid-template-columns: minmax(0, 1fr);
  }

  .cost-main-row {
    flex-direction: column;
    align-items: flex-start;
  }

  .cost-input {
    width: 100%;
    max-width: 100%;
    text-align: left;
  }
}

/* Bot√≥n dorado "Servicio activado" m√°s peque√±o y discreto */
.service-btn-gold {
  padding: 0.38rem 0.95rem !important;
  font-size: 0.8rem !important;
  border-radius: 0.7rem !important;
}
/* ============================================
   LAYOUT SIMPLE: CAJA DE PRECIO ARRIBA, CENTRADA
   (solo escritorio / pantallas grandes)
   ============================================ */
@media (min-width: 1024px) {
  /* El bloque superior deja de ser grid y pasa a columna */
  .prop-top-grid {
    display: flex !important;
    flex-direction: column-reverse !important;  /* primero caja de precio, luego texto+subidas */
    gap: 1.8rem !important;
    align-items: stretch !important;
  }

  /* Bloque de texto + subida ocupa todo el ancho */
  .prop-main {
    width: 100% !important;
    min-width: 0 !important;
  }

  /* Columna de costes: fila centrada */
  .prop-cost {
    width: 100% !important;
    min-width: 0 !important;
    max-width: 100% !important;
    display: flex !important;
    justify-content: center !important;
  }

  /* Caja dorada: centrada y con ancho controlado */
  .prop-cost .cost-box {
    width: 100% !important;
    max-width: 420px !important;   /* si la quieres m√°s grande, sube este valor */
    margin: 0 auto !important;
    box-sizing: border-box !important;
  }

  /* La fila ‚ÄúPrecio de la propiedad‚Äù + input, ordenada y sin empujar */
  .cost-main-row {
    display: flex !important;
    flex-wrap: wrap !important;
    justify-content: space-between !important;
    align-items: flex-start !important;
    gap: 0.6rem !important;
  }

  .cost-label {
    flex: 1 1 auto !important;
  }

  .cost-input {
    flex: 0 0 auto !important;
    min-width: 210px !important;
    max-width: 45% !important;
    text-align: right !important;
  }

  /* El panel sigue cortando cualquier cosa que intente salirse */
  .panel .card {
    overflow: hidden !important;
  }
}
  /* La fila ‚ÄúPrecio de la propiedad‚Äù + input, ordenada y sin empujar */
  .cost-main-row {
    display: flex !important;
    flex-wrap: wrap !important;
    justify-content: space-between !important;
    align-items: flex-start !important;
    gap: 0.6rem !important;
  }

  .cost-label {
    flex: 1 1 auto !important;
  }

  .cost-input {
    flex: 0 0 auto !important;
    min-width: 210px !important;
    max-width: 45% !important;
    text-align: right !important;
  }

  /* El panel sigue cortando cualquier cosa que intente salirse */
  .panel .card {
    overflow: hidden !important;
  }
}

/* ============================================
   BOTONES DE SERVICIO M√ÅS PEQUE√ëOS Y COMPACTOS
   (solo los de la rejilla de servicios)
   ============================================ */
.upload-counter {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  margin-left: 0.5rem;
  min-width: 1.3rem;
  height: 1.3rem;
  border-radius: 999px;
  border: 1px solid #38bdf8;
  font-size: 0.72rem;
  color: #e5e7eb;
}

.upload-progress {
  font-size: 0.72rem;
  color: #38bdf8;
  margin-left: 0.6rem;
}
    .services-grid .service-btn,
.services-grid .service-btn-gold,
.services-grid .service-btn-done {
  padding: 0.32rem 0.75rem !important;
  font-size: 0.75rem !important;
  border-radius: 0.55rem !important;
  line-height: 1.1 !important;
  min-height: 0 !important;
}

.services-grid .service-btn-gold {
  padding: 0.35rem 0.85rem !important;
}

.services-grid .service-btn-gold .crown {
  font-size: 0.75rem !important;
}
/* ============================================
   BOTONES DE SERVICIO M√ÅS PEQUE√ëOS Y COMPACTOS
   ============================================ */

.service-card .service-btn,
.service-card .service-btn-gold,
.service-card .service-btn-done {
  padding: 0.32rem 0.75rem !important;
  font-size: 0.75rem !important;
  border-radius: 0.55rem !important;
  line-height: 1.1 !important;
  min-height: 0 !important;
}

.service-card .service-btn-gold {
  padding: 0.35rem 0.85rem !important;
}

.service-card .service-btn-gold .crown {
  font-size: 0.75rem !important;
}
</style>
</head>
<body>
  <div class="page">
  <header>
  <div class="logo">
    <div class="logo-icon"></div>
    <div class="logo-text">
      <span>Panamove</span>
    </div>
  </div>

  <div class="header-actions">
    <a href="index.html" class="btn-mini">‚Üê Volver</a>
  </div>
</header>

<main>
  <div class="page-title">
    <h1>TEST PANEL 123 üöß</h1>
    <p>Informaci√≥n para propietarios, agencias, difusores y auditor√≠a.</p>
  </div>


      <div class="tabs">
        <button class="tab active" data-tab="propietario">Propietario</button>
        <button class="tab" data-tab="agencia">Agencia / Profesional</button>
        <button class="tab" data-tab="difusor">Difusores / Creadores</button>
        <button class="tab" data-tab="auditor">Auditor√≠a</button>
      </div>

      <div class="grid">
               <!-- PANEL PROPIETARIO -->
        <section id="panel-propietario" class="panel">
          <div class="card">

            <!-- BLOQUE SUPERIOR EN DOS COLUMNAS -->
            <div class="prop-top-grid">
              <!-- Columna izquierda: t√≠tulo + badges + subida archivos -->
              <div class="prop-main">
                <h2 class="titulo-principal">Propietario ‚Äì √Åtico Blue Sunset</h2>
                <p>Resumen de la campa√±a de venta de una vivienda real dentro del sistema 7.0.</p>

                <div class="badge-row">
                  <span class="badge">2 dorm ¬∑ 2 ba√±os</span>
                  <span class="badge">Vistas al mar</span>
                  <span class="badge">La Duquesa ¬∑ Manilva</span>
                  <span class="badge">Campa√±a activa</span>
                </div>

                <!-- SUBIR FOTOS / DOCUMENTACI√ìN -->
                <div class="upload-section">
                  <h3 class="section-title">Subir fotos y documentaci√≥n</h3>
                  <div class="upload-grid">
                    <div class="upload-card">
                      <h3>Subir fotos de la vivienda</h3>
                      <p></p>
                      <div class="upload-drop" id="drop-fotos">
                        <span style="font-size:.78rem;color:#9ca3af;">Arrastra las fotos aqu√≠</span>
                        <button type="button" class="upload-btn" id="btn-fotos-select">Subir / arrastrar fotos</button>
                        <input type="file" id="input-fotos" accept="image/*" multiple style="display:none;" />
                      </div>
                    </div>
                    <div class="upload-card">
                      <h3>Subir documentaci√≥n</h3>
                      <p></p>
                      <div class="upload-drop" id="drop-docs">
                        <span style="font-size:.78rem;color:#9ca3af;">Arrastra la documentaci√≥n aqu√≠</span>
                        <button type="button" class="upload-btn" id="btn-docs-select">Subir / arrastrar documentaci√≥n</button>
                        <input type="file" id="input-docs" multiple style="display:none;" />
                      </div>
                    </div>
                  </div>
                  <div class="upload-actions">
  <button type="button" class="upload-view-btn" id="btn-ver-fotos">
    Ver fotos subidas
    <span id="badge-fotos" class="upload-counter"></span>
    <span id="progress-fotos" class="upload-progress"></span>
  </button>

  <button type="button" class="upload-view-btn" id="btn-ver-docs">
    Ver documentaci√≥n subida
    <span id="badge-docs" class="upload-counter"></span>
    <span id="progress-docs" class="upload-progress"></span>
  </button>
</div>

                </div>
              </div>

              <!-- Columna derecha: CAJA DE PRECIO / NETO -->
              <div class="prop-cost">
                <div class="cost-box">
                  <div class="cost-main-row">
                    <span class="cost-label">Precio de la propiedad</span>
                    <input type="text" id="precio-propiedad" class="cost-input" placeholder="Introduce el precio" />
                  </div>
                  <div class="cost-line">
                    <span class="cost-line-label">Total servicios activados (sin IVA):</span>
                    <span class="cost-line-value" id="cost-servicios">0,00 ‚Ç¨</span>
                  </div>
                  <div class="cost-line">
                    <span class="cost-line-label">IVA servicios 21 %:</span>
                    <span class="cost-line-value" id="cost-iva-servicios">0,00 ‚Ç¨</span>
                  </div>
                  <div class="cost-line">
                    <span class="cost-line-label">Comisi√≥n 3 % gesti√≥n:</span>
                    <span class="cost-line-value" id="cost-comision">0,00 ‚Ç¨</span>
                  </div>
                  <div class="cost-line">
                    <span class="cost-line-label">IVA 21 % comisi√≥n:</span>
                    <span class="cost-line-value" id="cost-iva-comision">0,00 ‚Ç¨</span>
                  </div>
                  <div class="cost-line cost-net">
                    <span class="cost-line-label">Neto para el propietario (antes de plusval√≠a):</span>
                    <span class="cost-line-value" id="cost-neto">0,00 ‚Ç¨</span>
                  </div>
                  <p class="cost-note">
                  No incluye plusval√≠a municipal, IRPF u otros impuestos.
                  </p>
                </div>
              </div>
            </div>
            <!-- FIN BLOQUE SUPERIOR EN DOS COLUMNAS -->

            <!-- ACCIONES ACTIVADAS POR EL PROPIETARIO -->
            <div class="range-card">
              <h3 class="titulo-principal">Acciones activadas por el propietario</h3>
              <div class="range-row">
                <button class="range-btn range-btn-active" data-owner-range="1-4">1‚Äì4</button>
                <button class="range-btn" data-owner-range="5-8">5‚Äì8</button>
                <button class="range-btn" data-owner-range="9-12">9‚Äì12</button>
                <button class="range-btn" data-owner-range="13-16">13‚Äì16</button>
                <button class="range-btn" data-owner-range="17-20">17‚Äì20</button>
                <button class="range-btn" data-owner-range="21-24">21‚Äì24</button>
                <button class="range-btn" data-owner-range="25-28">25‚Äì28</button>
                <button class="range-btn" data-owner-range="all">Todos</button>
              </div>
            </div>
            <div id="owner-actions-dynamic" class="owner-actions-dynamic">
              <p class="owner-empty">A√∫n no has activado ning√∫n servicio. En cuanto actives uno, aparecer√° aqu√≠.</p>
            </div>

            <!-- SERVICIOS DISPONIBLES -->
            <div class="range-card">
             <h3 class="titulo-principal">Servicios disponibles (tarifas ejemplo)</h3>
             <div class="range-row">

              <button class="range-btn" data-service-range="all">Todos</button>
              <button class="range-btn range-btn-active" data-service-range="1-4">1‚Äì4</button>
              <button class="range-btn" data-service-range="5-8">5‚Äì8</button>
              <button class="range-btn" data-service-range="9-12">9‚Äì12</button>
              <button class="range-btn" data-service-range="13-16">13‚Äì16</button>
              <button class="range-btn" data-service-range="17-20">17‚Äì20</button>
              <button class="range-btn" data-service-range="21-24">21‚Äì24</button>
              <button class="range-btn" data-service-range="25-28">25‚Äì28</button>
            </div>

            <div class="services-grid">
              <!-- 1 -->
              <div class="service-item" data-index="1">
                <strong>Fotos PRO</strong>
                <div class="service-meta">450 ‚Ç¨ ¬∑ pago a √©xito</div>
                <div class="service-meta">Fot√≥grafo especializado inmobiliario.</div>
                <button class="service-btn" data-service="fotos">Activar este servicio</button>
              </div>
              <!-- 2 -->
              <div class="service-item" data-index="2">
                <strong>V√≠deo + dron</strong>
                <div class="service-meta">450 ‚Ç¨ ¬∑ pago a √©xito</div>
                <div class="service-meta">Recorrido interior + vistas a√©reas.</div>
                <button class="service-btn" data-service="video">Activar este servicio</button>
              </div>
              <!-- 3 -->
              <div class="service-item" data-index="3">
                <strong>Home staging</strong>
                <div class="service-meta">750‚Äì1200 ‚Ç¨</div>
                <div class="service-meta">Mejora est√©tica sin reformas pesadas.</div>
                <button class="service-btn" data-service="staging">Activar este servicio</button>
              </div>
              <!-- 4 -->
              <div class="service-item" data-index="4">
                <strong>Blogger internacional</strong>
                <div class="service-meta">3000 ‚Ç¨ ¬∑ pago a √©xito</div>
                <div class="service-meta">Historia real en otro pa√≠s.</div>
                <button class="service-btn" data-service="blogger">Activar este servicio</button>
              </div>
              <!-- (el resto de servicios 5‚Äì28 se queda tal como ya lo ten√≠as) -->
            </div>

            <p class="hint">
              El propietario ve esto como ‚Äúpanel de mando‚Äù: qu√© est√° activo, qu√© falta por activar y qu√© servicios ya han sido realizados.
            </p>
          </div>
        </section>
        <!-- PANEL AGENCIA -->
        <section id="panel-agencia" class="panel" style="display:none;">
          <div class="card">
            <h2>Agencia 7.0 ‚Äì Centro de producci√≥n</h2>
            <p>Vista para agencias que dejan de vivir de exclusivas vac√≠as y pasan a producir resultados.</p>

            <div class="badge-row">
              <span class="badge">Equipo 7.0 Activo</span>
              <span class="badge">Comercial aut√≥nomo</span>
              <span class="badge">Abogado interno</span>
              <span class="badge">Valorador profesional</span>
            </div>

            <div class="section-title">Servicios que ofrece la agencia dentro de la plataforma</div>
            <ul style="list-style:none;padding-left:0;margin:0;">
              <li style="font-size:.85rem;color:#e5e7eb;margin-bottom:.25rem;">‚Ä¢ Acompa√±amiento a visitas: comercial aut√≥nomo cobra por visita cualificada.</li>
              <li style="font-size:.85rem;color:#e5e7eb;margin-bottom:.25rem;">‚Ä¢ Valoraciones profesionales con informe completo de mercado.</li>
              <li style="font-size:.85rem;color:#e5e7eb;margin-bottom:.25rem;">‚Ä¢ Gesti√≥n de reportajes y contenido audiovisual para varias viviendas a la vez.</li>
              <li style="font-size:.85rem;color:#e5e7eb;margin-bottom:.1rem;">‚Ä¢ Coordinaci√≥n con bloggers, difusores y propietarios dentro del mismo sistema.</li>
            </ul>

            <div class="section-title">Acciones de profesionales sobre los servicios activos</div>
            <div class="agency-actions">
              <p>Ejemplo real de flujo 7.0: los profesionales marcan aqu√≠ cu√°ndo han completado su trabajo.</p>
              <div class="agency-grid">
                <div>
                  <strong>Fot√≥grafo</strong>
                  <div class="service-meta">Fotos PRO</div>
                  <button class="agency-btn" data-prof-service="fotos">Marcar fotos como entregadas</button>
                </div>
                <div>
                  <strong>Vide√≥grafo / dron</strong>
                  <div class="service-meta">V√≠deo + dron</div>
                  <button class="agency-btn" data-prof-service="video">Marcar v√≠deo como entregado</button>
                </div>
                <div>
                  <strong>Interiorista</strong>
                  <div class="service-meta">Home staging</div>
                  <button class="agency-btn" data-prof-service="staging">Marcar staging realizado</button>
                </div>
                <div>
                  <strong>Blogger internacional</strong>
                  <div class="service-meta">Publicaci√≥n historia</div>
                  <button class="agency-btn" data-prof-service="blogger">Marcar post publicado</button>
                </div>
                <div>
                  <strong>Abogado</strong>
                  <div class="service-meta">Revisi√≥n legal</div>
                  <button class="agency-btn" data-prof-service="legal">Marcar informe entregado</button>
                </div>
              </div>
            </div>

            <div class="kpis">
              <div class="kpi">
                <label>Propiedades activas</label>
                <span>12</span>
              </div>
              <div class="kpi">
                <label>Visitas esta semana</label>
                <span>24</span>
              </div>
              <div class="kpi">
                <label>Ventas cerradas mes</label>
                <span>3</span>
              </div>
              <div class="kpi">
                <label>Honorarios a cobrar</label>
                <span>18.500 ‚Ç¨</span>
              </div>
            </div>

            <p class="hint">
              La agencia ve el sistema como una f√°brica de resultados: menos escaparate, m√°s contenido, m√°s foco en servicios realizados y cierres reales.
            </p>
          </div>
        </section>

        <!-- PANEL DIFUSOR -->
        <section id="panel-difusor" class="panel" style="display:none;">
          <div class="card">
            <h2>Difusores y creadores</h2>
            <p>Personas que no son agentes, pero tienen audiencia y pueden ayudar a vender compartiendo historias reales.</p>

            <div class="badge-row">
              <span class="badge">Bloggers</span>
              <span class="badge">YouTubers</span>
              <span class="badge">Influencers</span>
              <span class="badge">Gente normal con redes</span>
            </div>

            <div class="section-title">C√≥mo funciona para un difusor</div>
            <ul style="list-style:none;padding-left:0;margin:0;">
              <li style="font-size:.85rem;color:#e5e7eb;margin-bottom:.25rem;">‚Ä¢ Se registra como difusor en la plataforma.</li>
              <li style="font-size:.85rem;color:#e5e7eb;margin-bottom:.25rem;">‚Ä¢ Recibe un enlace o material de la vivienda para compartir en sus redes.</li>
              <li style="font-size:.85rem;color:#e5e7eb;margin-bottom:.25rem;">‚Ä¢ Su tr√°fico se registra: clics, interesados, visitas programadas.</li>
              <li style="font-size:.85rem;color:#e5e7eb;margin-bottom:.1rem;">‚Ä¢ Si la vivienda se vende y su difusi√≥n ha tenido impacto real, cobra una cantidad pactada.</li>
            </ul>

            <div class="section-title">Ejemplo de recompensa</div>
            <div class="services-grid">
              <div class="service-item">
                <strong>Difusor local</strong>
                <div class="service-meta">Publica en grupos y contactos</div>
                <div class="service-meta">Ejemplo: hasta 500‚Äì1000 ‚Ç¨ al cierre seg√∫n impacto.</div>
              </div>
              <div class="service-item">
                <strong>Influencer nicho extranjero</strong>
                <div class="service-meta">P√∫blico comprador de tu zona</div>
                <div class="service-meta">Ejemplo: 2000‚Äì3000 ‚Ç¨ a √©xito.</div>
              </div>
            </div>

            <div class="kpis">
              <div class="kpi">
                <label>Difusores activos</label>
                <span>14</span>
              </div>
              <div class="kpi">
                <label>Alcance estimado</label>
                <span>23.000</span>
              </div>
              <div class="kpi">
                <label>Viviendas con difusi√≥n 7.0</label>
                <span>8</span>
              </div>
            </div>

            <p class="hint">
              Todo el sistema est√° pensado para repartir valor: si tu difusi√≥n ayuda a vender, cobras. Si no, nadie te cobra ni cobra.
            </p>
          </div>
        </section>

        <!-- PANEL AUDITOR -->
        <section id="panel-auditor" class="panel" style="display:none;">
          <div class="card">
            <h2>Auditor√≠a 7.0</h2>
            <p>Una visi√≥n simple de c√≥mo se podr√≠a registrar qui√©n participa, qu√© se activa y qu√© se paga al cierre.</p>

            <div class="badge-row">
              <span class="badge">Registro de acciones</span>
              <span class="badge">Transparencia</span>
              <span class="badge">Preparado para notar√≠a</span>
            </div>

            <div class="kpis">
              <div class="kpi">
                <label>Acciones registradas</label>
                <span id="kpi-acciones">32</span>
              </div>
              <div class="kpi">
                <label>Profesionales implicados</label>
                <span>9</span>
              </div>
              <div class="kpi">
                <label>Difusores con impacto</label>
                <span>4</span>
              </div>
              <div class="kpi">
                <label>Importe a repartir</label>
                <span id="kpi-importe">12.300 ‚Ç¨</span>
              </div>
            </div>

            <div class="section-title">Ejemplo de ‚Äúregistro‚Äù de la vivienda</div>
            <div class="log" id="audit-log">
              <div class="log-entry"><strong>Propietario</strong> activa Fotos PRO (450 ‚Ç¨ a √©xito).</div>
              <div class="log-entry"><strong>Propietario</strong> activa V√≠deo + dron (450 ‚Ç¨ a √©xito).</div>
              <div class="log-entry"><strong>Agencia 7.0</strong> asigna comercial aut√≥nomo para visitas (50 ‚Ç¨/visita).</div>
              <div class="log-entry"><strong>Abogado</strong> registra revisi√≥n legal pendiente (250 ‚Ç¨ al cierre).</div>
              <div class="log-entry"><strong>Blogger FR</strong> publica historia sobre ‚Äú√°tico con vistas a √Åfrica‚Äù.</div>
              <div class="log-entry"><strong>Difusor local</strong> comparte la vivienda en grupos de la zona.</div>
              <div class="log-entry"><strong>Venta</strong>: se cierra operaci√≥n y se reparte el valor entre implicados.</div>
            </div>

            <p class="hint">
              En la versi√≥n completa, este panel se conectar√≠a a una base de datos y, si se quiere, a la notar√≠a para verificar que los pagos a √©xito quedan reflejados de forma justa.
            </p>
          </div>
        </section>
      </div>
    </main>

    <footer>
      Plataforma 7.0 ‚Äì Panel demostraci√≥n ¬∑ Esta p√°gina es un prototipo visual est√°tico pensado para explicar el sistema.
    </footer>
  </div>

  <!-- MODAL -->
  <div class="modal-backdrop" id="modal">
    <div class="modal-card">
      <div class="modal-header">
        <div class="modal-title" id="modal-title">Archivos subidos</div>
        <button type="button" class="modal-close" id="modal-close">Cerrar</button>
      </div>
      <div class="modal-body" id="modal-body">
        <!-- contenido din√°mico -->
      </div>
    </div>
  </div>

   <script>
    // ------- TABS -------
    const tabs = document.querySelectorAll('.tab');
    const panels = document.querySelectorAll('.panel');

    function showTab(name){
      panels.forEach(p => {
        if(p.id === 'panel-' + name){ p.style.display = '' }
        else { p.style.display = 'none' }
      });
      tabs.forEach(t => {
        t.classList.toggle('active', t.dataset.tab === name);
      });
    }

    tabs.forEach(t => t.addEventListener('click', () => showTab(t.dataset.tab)));
    showTab('propietario');

    // ------- ESTADOS SERVICIOS -------
    const serviceButtons = document.querySelectorAll('.service-btn[data-service]');
    const fullActionsBtn = document.getElementById('btn-full-acciones');
    const profButtons = document.querySelectorAll('.agency-btn');
    const auditLog = document.getElementById('audit-log');
    const originalLogHTML = auditLog ? auditLog.innerHTML : '';
    const kpiAcciones = document.getElementById('kpi-acciones');
    const kpiImporte = document.getElementById('kpi-importe');

    const costServiciosEl    = document.getElementById('cost-servicios');
    const costIvaServiciosEl = document.getElementById('cost-iva-servicios');
    const costComisionEl     = document.getElementById('cost-comision');
    const costIvaComisionEl  = document.getElementById('cost-iva-comision');
    const costNetoEl         = document.getElementById('cost-neto');
    const precioPropiedadInput = document.getElementById('precio-propiedad');

    const ownerActionsContainer = document.getElementById('owner-actions-dynamic');
    const ownerRangeButtons = document.querySelectorAll('[data-owner-range]');
    let currentOwnerRange = '1-4';

    const serviceRangeButtons = document.querySelectorAll('[data-service-range]');
    let currentServiceRange = '1-4';

    const estadosServicios = {};
    const serviceOrder = [
      'fotos','video','staging','blogger','legal',
      'acomp_visitas','atencion_llamadas','gestion_agenda','informe_semanal',
      'campanas_redes','difusores_locales','influencers_extranjeros',
      'tour_3d','reportaje_nocturno','copywriting','carta_venta',
      'valoracion_basica','valoracion_ampliada','informe_fiscal','cert_energetico',
      'planos','limpieza','pequenos_arreglos','lavado_cara',
      'optim_terraza','reformas_ligeras','asistente_personal','gestion_total'
    ];

    const serviceConfig = {
      fotos: { label: 'Fotos PRO', logOn: 'activa Fotos PRO (450 ‚Ç¨ a √©xito).', logDone: 'marca Fotos PRO como realizadas y entregadas.', importe: 450 },
      video: { label: 'V√≠deo + dron', logOn: 'activa V√≠deo + dron (450 ‚Ç¨ a √©xito).', logDone: 'marca el v√≠deo + dron como entregado.', importe: 450 },
      staging: { label: 'Home staging', logOn: 'solicita Home staging (750‚Äì1200 ‚Ç¨ a √©xito).', logDone: 'marca el Home staging como realizado en la vivienda.', importe: 900 },
      blogger: { label: 'Blogger internacional', logOn: 'activa Blogger internacional (3000 ‚Ç¨ a √©xito).', logDone: 'confirma que el post del blogger internacional ha sido publicado.', importe: 3000 },
      legal: { label: 'Revisi√≥n legal', logOn: 'solicita revisi√≥n legal (250 ‚Ç¨ al cierre).', logDone: 'marca la revisi√≥n legal como completada y lista para notar√≠a.', importe: 250 },
      acomp_visitas: { label: 'Acompa√±amiento a visitas', logOn: 'activa acompa√±amiento profesional a visitas (50 ‚Ç¨ por visita).', logDone: 'marca que las visitas han sido acompa√±adas y reportadas.', importe: 200 },
      atencion_llamadas: { label: 'Atenci√≥n de llamadas', logOn: 'activa servicio de atenci√≥n de llamadas y filtro de compradores.', logDone: 'marca que el servicio de llamadas ha sido prestado correctamente.', importe: 120 },
      gestion_agenda: { label: 'Gesti√≥n de agenda', logOn: 'activa la gesti√≥n de agenda de visitas y recordatorios.', logDone: 'marca la gesti√≥n de agenda como realizada durante el periodo pactado.', importe: 150 },
      informe_semanal: { label: 'Informe semanal', logOn: 'activa el informe semanal de estado de la venta.', logDone: 'marca que los informes semanales han sido entregados.', importe: 90 },
      campanas_redes: { label: 'Campa√±a redes sociales', logOn: 'activa una campa√±a segmentada en redes sociales.', logDone: 'marca que la campa√±a en redes ha sido ejecutada.', importe: 150 },
      difusores_locales: { label: 'Red difusores locales', logOn: 'activa la difusi√≥n en redes y grupos locales.', logDone: 'marca que la campa√±a con difusores locales se ha realizado.', importe: 500 },
      influencers_extranjeros: { label: 'Influencers extranjeros', logOn: 'activa colaboraci√≥n con influencers extranjeros a √©xito.', logDone: 'marca que la campa√±a con influencers se ha publicado.', importe: 2500 },
      tour_3d: { label: 'Tour virtual 3D', logOn: 'solicita la creaci√≥n de un tour virtual 3D.', logDone: 'marca el tour virtual 3D como entregado.', importe: 300 },
      reportaje_nocturno: { label: 'Reportaje nocturno', logOn: 'activa reportaje fotogr√°fico al atardecer o nocturno.', logDone: 'marca el reportaje nocturno como realizado.', importe: 120 },
      copywriting: { label: 'Copywriting premium', logOn: 'solicita redacci√≥n premium del anuncio.', logDone: 'marca el copywriting como entregado.', importe: 70 },
      carta_venta: { label: 'Carta de venta', logOn: 'activa la creaci√≥n de una carta de venta en PDF.', logDone: 'marca la carta de venta como entregada.', importe: 130 },
      valoracion_basica: { label: 'Valoraci√≥n profesional', logOn: 'activa una valoraci√≥n profesional b√°sica.', logDone: 'marca la valoraci√≥n profesional como entregada.', importe: 180 },
      valoracion_ampliada: { label: 'Valoraci√≥n ampliada', logOn: 'activa una valoraci√≥n ampliada con estrategia.', logDone: 'marca la valoraci√≥n ampliada como entregada.', importe: 250 },
      informe_fiscal: { label: 'Informe fiscal', logOn: 'solicita informe fiscal de la operaci√≥n.', logDone: 'marca el informe fiscal como entregado.', importe: 180 },
      cert_energetico: { label: 'Certificado energ√©tico', logOn: 'activa la gesti√≥n del certificado energ√©tico.', logDone: 'marca el certificado energ√©tico como emitido.', importe: 80 },
      planos: { label: 'Plano profesional', logOn: 'solicita plano profesional 2D/3D.', logDone: 'marca el plano profesional como entregado.', importe: 130 },
      limpieza: { label: 'Limpieza profesional', logOn: 'activa limpieza profesional de la vivienda.', logDone: 'marca la limpieza profesional como realizada.', importe: 100 },
      pequenos_arreglos: { label: 'Peque√±os arreglos', logOn: 'activa el servicio de peque√±os arreglos.', logDone: 'marca los arreglos como finalizados.', importe: 250 },
      lavado_cara: { label: 'Lavado de cara expr√©s', logOn: 'activa el lavado de cara expr√©s.', logDone: 'marca la mejora expr√©s como realizada.', importe: 450 },
      optim_terraza: { label: 'Optimizaci√≥n de terraza', logOn: 'activa la optimizaci√≥n est√©tica de la terraza.', logDone: 'marca la optimizaci√≥n de terraza como completada.', importe: 400 },
      reformas_ligeras: { label: 'Reformas ligeras', logOn: 'activa un paquete de reformas ligeras.', logDone: 'marca las reformas ligeras como finalizadas.', importe: 800 },
      asistente_personal: { label: 'Asistente personal 7.0', logOn: 'activa el servicio de asistente personal 7.0.', logDone: 'marca el acompa√±amiento 7.0 como realizado.', importe: 150 },
      gestion_total: { label: 'Gesti√≥n total 7.0', logOn: 'activa gesti√≥n total 7.0 (3 % a √©xito).', logDone: 'marca la gesti√≥n total como realizada hasta notar√≠a.', importe: 0 }
    };

    function parseRange(str){
      if (!str || str === 'all') return null;
      const parts = str.split('-').map(Number);
      if (parts.length !== 2 || isNaN(parts[0]) || isNaN(parts[1])) return null;
      return {min:parts[0], max:parts[1]};
    }

    function formatEuro(num){
      if (isNaN(num) || !isFinite(num)) num = 0;
      return num.toLocaleString('es-ES', { minimumFractionDigits: 2, maximumFractionDigits: 2 }) + ' ‚Ç¨';
    }

    function getPrecioPropiedad(){
      if (!precioPropiedadInput) return 0;
      const raw = precioPropiedadInput.value.replace(/\./g,'').replace(',', '.');
      const val = parseFloat(raw);
      return isNaN(val) ? 0 : val;
    }

    function renderServiceVisibility(){
      const range = parseRange(currentServiceRange);
      const items = document.querySelectorAll('.service-item');
      items.forEach(div => {
        const idx = Number(div.dataset.index);
        if (!range) {
          div.style.display = '';
        } else {
          div.style.display = (idx >= range.min && idx <= range.max) ? '' : 'none';
        }
      });
      serviceRangeButtons.forEach(btn => {
        btn.classList.toggle('range-btn-active', btn.dataset.serviceRange === currentServiceRange);
      });
    }

    function renderOwnerActions(){
      const range = parseRange(currentOwnerRange);
      ownerRangeButtons.forEach(btn => {
        btn.classList.toggle('range-btn-active', btn.dataset.ownerRange === currentOwnerRange);
      });

      ownerActionsContainer.innerHTML = '';
      const activos = [];
      serviceOrder.forEach(id => {
        const state = estadosServicios[id];
        if (state === 'on' || state === 'done') {
          activos.push(id);
        }
      });

      if (activos.length === 0){
        const p = document.createElement('p');
        p.className = 'owner-empty';
        p.textContent = 'A√∫n no has activado ning√∫n servicio. En cuanto actives uno, aparecer√° aqu√≠.';
        ownerActionsContainer.appendChild(p);
        return;
      }

      activos.forEach((id, index) => {
        const idx = index + 1;
        const show = !range || (idx >= range.min && idx <= range.max);
        if (!show) return;

        const cfg = serviceConfig[id];
        const pill = document.createElement('div');
        pill.className = 'owner-pill';
        const dot = document.createElement('span');
        dot.className = 'owner-pill-dot';
        const text = document.createElement('span');
        const state = estadosServicios[id];
        if (state === 'done') {
          text.textContent = (cfg?.label || id) + ' completado por profesionales 7.0';
        } else {
          text.textContent = (cfg?.label || id) + ' activado por el propietario';
        }
        pill.appendChild(dot);
        pill.appendChild(text);
        ownerActionsContainer.appendChild(pill);
      });

      if (!ownerActionsContainer.children.length){
        const p = document.createElement('p');
        p.className = 'owner-empty';
        p.textContent = 'No hay acciones en este rango. Cambia el filtro superior o activa m√°s servicios.';
        ownerActionsContainer.appendChild(p);
      }
    }

    function renderServicios(){
      const estados = estadosServicios;

      // --- Botones de servicios (propietario) ---
      serviceButtons.forEach(btn => {
        const id = btn.dataset.service;
        const state = estados[id] || 'off';
        btn.classList.remove('service-btn-active','service-btn-done','service-btn-gold');
        btn.disabled = false;
        btn.innerHTML = 'Activar este servicio';

        if (state === 'on') {
          btn.classList.add('service-btn-gold');
          btn.innerHTML = '<span class="crown">üëë</span><span>Servicio activado</span>';
        } else if (state === 'done') {
          btn.textContent = 'Acci√≥n realizada';
          btn.classList.add('service-btn-done');
          btn.disabled = true;
        }
      });

      // --- Botones profesionales (agencia) ---
      profButtons.forEach(btn => {
        const id = btn.dataset.profService;
        const state = estados[id] || 'off';
        if (state === 'done') {
          btn.disabled = true;
          btn.textContent = 'Acci√≥n ya marcada como realizada';
        } else {
          btn.disabled = false;
        }
      });

      // Si no hay panel de auditor√≠a salimos, pero actualizamos acciones
      if (!auditLog){
        renderOwnerActions();
        return;
      }

      const ids = Object.keys(estados).filter(id => estados[id] === 'on' || estados[id] === 'done');
      let totalImporte = 0;
      let countAcciones = 0;

      if (ids.length === 0){
        // Sin servicios: dejamos el log de ejemplo
        auditLog.innerHTML = originalLogHTML;
      } else {
        auditLog.innerHTML = '';
        ids.forEach(id => {
          const cfg = serviceConfig[id];
          if (!cfg) return;
          const state = estados[id];
          const div = document.createElement('div');
          div.className = 'log-entry';

          if (state === 'on') {
            div.innerHTML = `<strong>Propietario</strong> ${cfg.logOn}`;
          } else if (state === 'done') {
            div.innerHTML = `<strong>Profesional 7.0</strong> ${cfg.logDone}`;
          }

          auditLog.appendChild(div);

          if (typeof cfg.importe === 'number' && cfg.importe > 0){
            totalImporte += cfg.importe;
          }
          countAcciones++;
        });

        const extra = document.createElement('div');
        extra.className = 'log-entry';
        extra.innerHTML = '<strong>Nota</strong> ¬∑ Este registro es un ejemplo local. En la versi√≥n completa, cada acci√≥n se firma y verifica antes de llegar a notar√≠a.';
        auditLog.appendChild(extra);
      }

      // --- C√°lculo econ√≥mico SIEMPRE ---
      const precio        = getPrecioPropiedad();
      const baseServicios = totalImporte;
      const ivaServicios  = baseServicios * 0.21;

      // 3 % SIEMPRE sobre el precio de la propiedad
      const comisionBase  = precio * 0.03;
      const ivaComision   = comisionBase * 0.21;

      const neto = precio - baseServicios - ivaServicios - comisionBase - ivaComision;

      // KPIs auditor√≠a
      if (kpiAcciones){
        kpiAcciones.textContent = ids.length === 0 ? '32' : String(countAcciones);
      }
      if (kpiImporte){
        kpiImporte.textContent = ids.length === 0
          ? '12.300 ‚Ç¨'
          : formatEuro(baseServicios + comisionBase);
      }

      // Caja econ√≥mica
      if (costServiciosEl)    costServiciosEl.textContent    = formatEuro(baseServicios);
      if (costIvaServiciosEl) costIvaServiciosEl.textContent = formatEuro(ivaServicios);
      if (costComisionEl)     costComisionEl.textContent     = formatEuro(comisionBase);
      if (costIvaComisionEl)  costIvaComisionEl.textContent  = formatEuro(ivaComision);
      if (costNetoEl)         costNetoEl.textContent         = formatEuro(neto);

      // P√≠ldoras verdes
      renderOwnerActions();
    }

    // clicks servicios propietario
    serviceButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const id = btn.dataset.service;
        const current = estadosServicios[id] || 'off';
        if (current === 'done') return;

        if (current === 'off') {
          estadosServicios[id] = 'on';
        } else if (current === 'on') {
          estadosServicios[id] = 'off';
        }
        renderServicios();
      });
    });

    // FULL ACCIONES
    let fullActive = false;
    if (fullActionsBtn) {
      fullActionsBtn.addEventListener('click', () => {
        fullActive = !fullActive;
        if (fullActive) {
          serviceOrder.forEach(id => { estadosServicios[id] = 'on'; });
          fullActionsBtn.innerHTML = '<span class="crown">üëë</span><span>Full acciones 7.0 activas</span>';
        } else {
          serviceOrder.forEach(id => { estadosServicios[id] = 'off'; });
          fullActionsBtn.innerHTML = '<span class="crown">üëë</span><span>Full acciones 7.0</span>';
        }
        renderServicios();
      });
    }

    // clicks profesionales
    profButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        const id = btn.dataset.profService;
        const current = estadosServicios[id] || 'off';
        if (current === 'on' || current === 'off') {
          estadosServicios[id] = 'done';
          renderServicios();
        }
      });
    });

    // rango servicios
    serviceRangeButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        currentServiceRange = btn.dataset.serviceRange;
        renderServiceVisibility();
      });
    });

    // rango acciones propietario
    ownerRangeButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        currentOwnerRange = btn.dataset.ownerRange;
        renderOwnerActions();
      });
    });

    // cambio precio
    if (precioPropiedadInput) {
      precioPropiedadInput.addEventListener('input', () => {
        renderServicios();
      });
    }

    // primera renderizaci√≥n
    renderServiceVisibility();
    renderServicios();

    // ------- UPLOAD / MODAL -------
    const dropFotos = document.getElementById('drop-fotos');
    const dropDocs = document.getElementById('drop-docs');
    const inputFotos = document.getElementById('input-fotos');
    const inputDocs = document.getElementById('input-docs');
    const btnFotosSelect = document.getElementById('btn-fotos-select');
    const btnDocsSelect = document.getElementById('btn-docs-select');
    const btnVerFotos = document.getElementById('btn-ver-fotos');
    const btnVerDocs = document.getElementById('btn-ver-docs');

    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modal-title');
    const modalBody = document.getElementById('modal-body');
    const modalClose = document.getElementById('modal-close');

    const fotoFiles = [];
    const docFiles = [];

    function preventDefaults(e){
      e.preventDefault();
      e.stopPropagation();
    }

    function addDropEvents(area, handler){
      ['dragenter','dragover','dragleave','drop'].forEach(ev => {
        area.addEventListener(ev, preventDefaults);
      });
      ['dragenter','dragover'].forEach(ev => {
        area.addEventListener(ev, () => area.classList.add('drag-over'));
      });
      ['dragleave','drop'].forEach(ev => {
        area.addEventListener(ev, () => area.classList.remove('drag-over'));
      });
      area.addEventListener('drop', e => {
        const files = Array.from(e.dataTransfer.files || []);
        handler(files);
      });
    }

       function handleFotos(files){
      const valid = [];
      files.forEach(f => {
        if (f && f.type && f.type.startsWith('image/')) {
          fotoFiles.push(f);
          valid.push(f);
        }
      });

      if (valid.length){
        simulateUploadProgress('fotos', valid.length);
      }
      updateUploadCounters();
    }

    function handleDocs(files){
      const valid = [];
      files.forEach(f => {
        if (f) {
          docFiles.push(f);
          valid.push(f);
        }
      });

      if (valid.length){
        simulateUploadProgress('docs', valid.length);
      }
      updateUploadCounters();
    }

    // Simula la barra de porcentaje junto al bot√≥n
    function simulateUploadProgress(type, totalFiles){
      const progressSpan = (type === 'fotos')
        ? document.getElementById('progress-fotos')
        : document.getElementById('progress-docs');

      if (!progressSpan) return;

      let pct = 0;
      progressSpan.textContent = 'Cargando 0%';

      const step = 15;           // sube de 15 en 15
      const ms   = 180;          // cada 180 ms

      const interval = setInterval(() => {
        pct += step;
        if (pct >= 100){
          pct = 100;
          clearInterval(interval);
          progressSpan.textContent = '';   // al llegar a 100% se borra
          updateUploadCounters();          // y dejamos solo el (n)
        } else {
          progressSpan.textContent = `Cargando ${pct}%`;
        }
      }, ms);
    }

    // Actualiza los circulitos (1), (2)...
    function updateUploadCounters(){
      const fotosBadge = document.getElementById('badge-fotos');
      const docsBadge  = document.getElementById('badge-docs');

      if (fotosBadge) {
        fotosBadge.textContent = fotoFiles.length ? fotoFiles.length : '';
      }
      if (docsBadge) {
        docsBadge.textContent = docFiles.length ? docFiles.length : '';
      }
    }

    // Click en ‚ÄúSubir / arrastrar fotos‚Äù
    if (btnFotosSelect && inputFotos) {
      btnFotosSelect.addEventListener('click', () => inputFotos.click());
      inputFotos.addEventListener('change', e => {
        const files = Array.from(e.target.files || []);
        handleFotos(files);
      });
    }

    // Click en ‚ÄúSubir / arrastrar documentaci√≥n‚Äù
    if (btnDocsSelect && inputDocs) {
      btnDocsSelect.addEventListener('click', () => inputDocs.click());
      inputDocs.addEventListener('change', e => {
        const files = Array.from(e.target.files || []);
        handleDocs(files);
      });
    }

    // Drag & drop
    if (dropFotos) addDropEvents(dropFotos, handleFotos);
    if (dropDocs)  addDropEvents(dropDocs, handleDocs);

    // Abrir modal
    function openModal(type){
      if (!modal) return;
      modal.style.display = 'flex';
      modalBody.innerHTML = '';

      if (type === 'fotos') {
        modalTitle.textContent = 'Fotos subidas';
        buildGallery(fotoFiles, true);
      } else {
        modalTitle.textContent = 'Documentaci√≥n subida';
        buildGallery(docFiles, false);
      }
    }

    // Galer√≠a del modal
    function buildGallery(list, isImage){
      modalBody.innerHTML = '';

      if (!list.length){
        const p = document.createElement('p');
        p.className = 'modal-empty';
        p.textContent = 'Todav√≠a no has subido ning√∫n archivo.';
        modalBody.appendChild(p);
        updateUploadCounters();
        return;
      }

      list.forEach((file, idx) => {
        const item = document.createElement('div');
        item.className = 'modal-item';

        if (isImage) {
          const img = document.createElement('img');
          const url = URL.createObjectURL(file);
          img.src = url;
          img.alt = file.name || ('Foto ' + (idx + 1));
          img.style.cursor = 'pointer';
          img.addEventListener('click', () => {
            window.open(url, '_blank');
          });
          item.appendChild(img);
        }

        const name = document.createElement('div');
        name.className = 'modal-item-name';
        name.textContent = file.name || ('Archivo ' + (idx + 1));
        item.appendChild(name);

        const del = document.createElement('button');
        del.className = 'modal-delete';
        del.textContent = 'Eliminar';
        del.addEventListener('click', () => {
          list.splice(idx, 1);
          buildGallery(list, isImage);
          updateUploadCounters();
        });
        item.appendChild(del);

        modalBody.appendChild(item);
      });

      updateUploadCounters();
    }

    function closeModal(){
      if (modal) modal.style.display = 'none';
    }

    if (btnVerFotos) btnVerFotos.addEventListener('click', () => openModal('fotos'));
    if (btnVerDocs)  btnVerDocs.addEventListener('click', () => openModal('docs'));
    if (modalClose) modalClose.addEventListener('click', closeModal);
    if (modal) {
      modal.addEventListener('click', e => {
        if (e.target === modal) closeModal();
      });
    }
  </script>
</body>
</html>
