<!DOCTYPE html>
<html lang="es">
<head>
Â  <meta charset="UTF-8" />
Â  <title>Panamove 7.0 â€“ Dashboard campaÃ±a</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1" />
Â  <style>
Â  Â  /* Variables y Estilo Global (Ajustado para Coherencia Premium) */
Â  Â  :root {
Â  Â  Â  --bg-main: #0a0a0a; 
Â  Â  Â  --bg-card: #1c1c25; /* Fondo de tarjetas limpio */
Â  Â  Â  --bg-card-alt: #2a2a35;
Â  Â  Â  --accent: #4285f4; /* Azul Google principal */
Â  Â  Â  --accent-soft: rgba(66, 133, 244, 0.1);
Â  Â  Â  --accent-strong: #3367d6;
Â  Â  Â  --gold: #fbc02d; /* Amarillo dorado */
Â  Â  Â  --text-main: #e8eaed; /* Texto principal claro */
Â  Â  Â  --text-soft: #9aa0a6; /* Texto secundario gris */
Â  Â  Â  --border-subtle: #3c4043; /* Borde muy sutil */
Â  Â  Â  --danger: #ea4335; /* Rojo Google */
Â  Â  Â  --success: #34a853; /* Verde Google */
Â  Â  Â  --radius-lg: 12px;
Â  Â  Â  --radius-full: 9999px;
Â  Â  Â  --shadow-deep: 0 4px 10px rgba(0, 0, 0, 0.4);
Â  Â  Â  --shadow-float: 0 1px 3px rgba(0,0,0,0.2), 0 1px 2px rgba(0,0,0,0.12);
Â  Â  Â  --transition-fast: 0.2s ease-out;
Â  Â  }

Â  Â  * {
Â  Â  Â  box-sizing: border-box;
Â  Â  Â  margin: 0;
Â  Â  Â  padding: 0;
Â  Â  }

Â  Â  body {
Â  Â  Â  min-height: 100vh;
Â  Â  Â  font-family: 'Roboto', sans-serif;
Â  Â  Â  background-color: var(--bg-main);
Â  Â  Â  color: var(--text-main);
Â  Â  Â  display: flex;
Â  Â  }

Â  Â  a {
Â  Â  Â  color: inherit;
Â  Â  Â  text-decoration: none;
Â  Â  }
Â  Â  
Â  Â  button {
Â  Â  Â  border: none;
Â  Â  Â  background: none;
Â  Â  Â  cursor: pointer;
Â  Â  Â  font-family: inherit;
Â  Â  Â  color: inherit;
Â  Â  }

Â  Â  /* LAYOUT -------------------------------------------------------------- */

Â  Â  .page {
Â  Â  Â  display: flex;
Â  Â  Â  width: 100%;
Â  Â  Â  min-height: 100vh;
Â  Â  }

Â  Â  .sidebar {
Â  Â  Â  width: 250px;
Â  Â  Â  background-color: #121216; /* Fondo mÃ¡s sÃ³lido */
Â  Â  Â  border-right: 1px solid var(--border-subtle);
Â  Â  Â  padding: 1.5rem 1rem;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  gap: 1.5rem;
Â  Â  }

Â  Â  .brand {
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  gap: 0.8rem;
Â  Â  Â  margin-bottom: 1rem;
Â  Â  }

Â  Â  .brand-logo {
Â  Â  Â  width: 36px;
Â  Â  Â  height: 36px;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  background: linear-gradient(45deg, var(--accent), var(--success));
Â  Â  Â  box-shadow: 0 0 8px rgba(66, 133, 244, 0.4);
Â  Â  }

Â  Â  .brand-title strong {
Â  Â  Â  font-size: 1.1rem;
Â  Â  Â  font-weight: 700;
Â  Â  }

Â  Â  .brand-sub {
Â  Â  Â  font-size: 0.75rem;
Â  Â  Â  color: var(--text-soft);
Â  Â  }

Â  Â  .nav {
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  gap: 0.3rem;
Â  Â  }

Â  Â  .nav-item {
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  gap: 0.7rem;
Â  Â  Â  padding: 0.7rem 0.9rem;
Â  Â  Â  border-radius: var(--radius-lg);
Â  Â  Â  font-size: 0.9rem;
Â  Â  Â  color: var(--text-soft);
Â  Â  Â  transition: background var(--transition-fast), color var(--transition-fast);
Â  Â  Â  border: 1px solid transparent;
Â  Â  }

Â  Â  .nav-item:hover {
Â  Â  Â  background-color: var(--bg-card-alt);
Â  Â  Â  color: var(--text-main);
Â  Â  }

Â  Â  .nav-item-active {
Â  Â  Â  background-color: var(--accent-soft);
Â  Â  Â  color: var(--accent);
Â  Â  Â  border-color: var(--accent);
Â  Â  Â  font-weight: 500;
Â  Â  }

Â  Â  .sidebar-footer {
Â  Â  Â  margin-top: auto;
Â  Â  Â  font-size: 0.7rem;
Â  Â  Â  color: var(--text-soft);
Â  Â  Â  padding-top: 1rem;
Â  Â  Â  border-top: 1px solid var(--border-subtle);
Â  Â  }

Â  Â  .main {
Â  Â  Â  flex: 1;
Â  Â  Â  padding: 2rem 2.5rem;
Â  Â  Â  display: flex;
Â  Â  Â  flex-direction: column;
Â  Â  Â  gap: 1.8rem;
Â  Â  }

Â  Â  .top-bar {
Â  Â  Â  display: flex;
Â  Â  Â  justify-content: space-between;
Â  Â  Â  align-items: center;
Â  Â  Â  padding-bottom: 1.5rem;
Â  Â  Â  border-bottom: 1px solid var(--border-subtle);
Â  Â  }

Â  Â  .top-title {
Â  Â  Â  font-size: 1.8rem;
Â  Â  Â  font-weight: 700;
Â  Â  Â  color: var(--text-main);
Â  Â  }

Â  Â  .badge-sistema {
Â  Â  Â  border-radius: var(--radius-full);
Â  Â  Â  padding: 0.2rem 0.8rem;
Â  Â  Â  font-size: 0.75rem;
Â  Â  Â  text-transform: uppercase;
Â  Â  Â  color: var(--accent);
Â  Â  Â  border: 1px solid rgba(66, 133, 244, 0.4);
Â  Â  Â  background: var(--accent-soft);
Â  Â  Â  font-weight: 500;
Â  Â  }

Â  Â  /* WRAPPERS Y CARDS */

Â  Â  .grid {
Â  Â  Â  display: grid;
Â  Â  Â  grid-template-columns: repeat(2, minmax(0, 1fr));
Â  Â  Â  gap: 1.5rem;
Â  Â  }

Â  Â  .card {
Â  Â  Â  background-color: var(--bg-card);
Â  Â  Â  border-radius: var(--radius-lg);
Â  Â  Â  border: 1px solid var(--border-subtle);
Â  Â  Â  padding: 1.5rem;
Â  Â  Â  box-shadow: var(--shadow-float);
Â  Â  }

Â  Â  /* PANEL DE AGENCIA ESPECÃFICO */
Â  Â  .agency-avatar {
Â  Â  Â  width: 50px;
Â  Â  Â  height: 50px;
Â  Â  Â  background-color: var(--success);
Â  Â  Â  color: var(--bg-card);
Â  Â  Â  border-radius: 50%;
Â  Â  Â  font-weight: 700;
Â  Â  Â  font-size: 1.2rem;
Â  Â  Â  display: flex;
Â  Â  Â  align-items: center;
Â  Â  Â  justify-content: center;
Â  Â  Â  flex-shrink: 0;
Â  Â  }
Â  Â  
Â  Â  .agency-service-pill {
Â  Â  Â  border-radius: var(--radius-full);
Â  Â  Â  padding: 0.4rem 0.9rem;
Â  Â  Â  font-size: 0.78rem;
Â  Â  Â  display: inline-flex;
Â  Â  Â  align-items: center;
Â  Â  Â  gap: 0.4rem;
Â  Â  Â  border: 1px solid var(--success);
Â  Â  Â  background-color: rgba(52, 168, 83, 0.1);
Â  Â  Â  color: var(--success);
Â  Â  Â  font-weight: 500;
Â  Â  }

Â  Â  .agency-service-pill .dot {
Â  Â  Â  width: 8px;
Â  Â  Â  height: 8px;
Â  Â  Â  border-radius: 50%;
Â  Â  Â  background: var(--success);
Â  Â  Â  flex-shrink: 0;
Â  Â  }

Â  Â  .btn-campana-firmada {
Â  Â  Â  align-self: flex-start;
Â  Â  Â  border-radius: var(--radius-lg);
Â  Â  Â  padding: 0.8rem 2rem;
Â  Â  Â  font-size: 1rem;
Â  Â  Â  font-weight: 700;
Â  Â  Â  background: var(--accent);
Â  Â  Â  color: white;
Â  Â  Â  box-shadow: var(--shadow-deep);
Â  Â  Â  transition: background-color 0.1s;
Â  Â  Â  margin-top: 1.5rem;
Â  Â  }
Â  Â  .btn-campana-firmada:hover {
Â  Â  Â  background-color: var(--accent-strong);
Â  Â  }
Â  </style>
</head>
<body>
Â  <div class="page">
Â  Â  <aside class="sidebar">
Â  Â  Â  <div class="brand">
Â  Â  Â  Â  <div class="brand-logo"></div>
Â  Â  Â  Â  <div class="brand-title">
Â  Â  Â  Â  Â  <strong>Panamove 7.0</strong>
Â  Â  Â  Â  Â  <div class="brand-sub">
Â  Â  Â  Â  Â  Â  Herramienta de CampaÃ±a
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  </div>

Â  Â  Â  <nav class="nav">
Â  Â  Â  Â  <a href="dashboard-clean.html" class="nav-item nav-item-active">
Â  Â  Â  Â  Â  <span class="icon">ğŸ“Š</span>Dashboard
Â  Â  Â  Â  </a>
Â  Â  Â  Â  <a href="servicios.html" class="nav-item">
Â  Â  Â  Â  Â  <span class="icon">âš™ï¸</span>Servicios
Â  Â  Â  Â  </a>
Â  Â  Â  Â  <div class="nav-item">
Â  Â  Â  Â  Â  <span class="icon">ğŸ </span>Propiedades
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="nav-item">
Â  Â  Â  Â  Â  <span class="icon">ğŸ“¢</span>Difusores
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="nav-item">
Â  Â  Â  Â  Â  <span class="icon">ğŸ”</span>AuditorÃ­a
Â  Â  Â  Â  </div>
Â  Â  Â  </nav>

Â  Â  Â  <div class="sidebar-footer">
Â  Â  Â  Â  V. 7.0 | Â© 2025
Â  Â  Â  </div>
Â  Â  </aside>

Â  Â  <main class="main">
Â  Â  Â  <header class="top-bar">
Â  Â  Â  Â  <div class="top-left">
Â  Â  Â  Â  Â  <div class="top-title">Dashboard de GestiÃ³n</div>
Â  Â  Â  Â  Â  <div class="top-subtitle">
Â  Â  Â  Â  Â  Â  Prioridades y resumen de costes en tiempo real.
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="top-right">
Â  Â  Â  Â  Â  <span class="badge-sistema">
Â  Â  Â  Â  Â  Â  SISTEMA 7.0
Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  <a href="servicios.html" class="btn-ghost">
Â  Â  Â  Â  Â  Â  CatÃ¡logo de Servicios
Â  Â  Â  Â  Â  </a>
Â  Â  Â  Â  </div>
Â  Â  Â  </header>

Â  Â  Â  Â  Â  Â  <section class="grid">
Â  Â  Â  Â  <article class="card" id="precioCard">
Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  <div class="card-header-main">
Â  Â  Â  Â  Â  Â  Â  <div class="card-title">Precio de la propiedad</div>
Â  Â  Â  Â  Â  Â  Â  <div class="card-subtitle">
Â  Â  Â  Â  Â  Â  Â  Â  SimulaciÃ³n de costes con servicios activados e IVA.
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <button type="button" class="btn-mini" id="btnSimulacion" style="background-color: var(--accent-strong); color: white;">
Â  Â  Â  Â  Â  Â  Â  SIMULAR
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="price-input-row">
Â  Â  Â  Â  Â  Â  <span>Precio Orientativo (â‚¬):</span>
Â  Â  Â  Â  Â  Â  <input
Â  Â  Â  Â  Â  Â  Â  type="number"
Â  Â  Â  Â  Â  Â  Â  id="precioInput"
Â  Â  Â  Â  Â  Â  Â  value="545000"
Â  Â  Â  Â  Â  Â  Â  min="50000"
Â  Â  Â  Â  Â  Â  Â  step="1000"
Â  Â  Â  Â  Â  Â  />
Â  Â  Â  Â  Â  Â  <span>â‚¬</span>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="price-lines" id="priceLines"></div>
Â  Â  Â  Â  </article>

Â  Â  Â  Â  <article class="card">
Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  <div class="card-header-main">
Â  Â  Â  Â  Â  Â  Â  <div class="card-title">Venta particular y colaboraciÃ³n</div>
Â  Â  Â  Â  Â  Â  Â  <div class="card-subtitle">
Â  Â  Â  Â  Â  Â  Â  Â  Espacio para propietarios que aÃºn no han decidido agencia.
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="property-list">
Â  Â  Â  Â  Â  Â  <div class="property-main-name">
Â  Â  Â  Â  Â  Â  Â  Ãtico Blue Sunset â€“ La Duquesa, Manilva.
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <p>
Â  Â  Â  Â  Â  Â  Â  Esta propiedad coordina la venta particular con servicios activos
Â  Â  Â  Â  Â  Â  Â  profesionales (fotografÃ­a, home staging, etc.).
Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </article>
Â  Â  Â  </section>

Â  Â  Â  Â  Â  Â  <section class="grid">
Â  Â  Â  Â  <article class="card">
Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  <div class="card-header-main">
Â  Â  Â  Â  Â  Â  Â  <div class="card-title">Panel de Agencia</div>
Â  Â  Â  Â  Â  Â  Â  <div class="card-subtitle">
Â  Â  Â  Â  Â  Â  Â  Â  InformaciÃ³n de contacto y servicios asumidos.
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  
Â  Â  Â  Â  Â  <div class="agency-panel-content">
Â  Â  Â  Â  Â  Â  <div class="agency-info">
Â  Â  Â  Â  Â  Â  Â  <div class="agency-avatar">BR</div>
Â  Â  Â  Â  Â  Â  Â  <div class="agency-details">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="agency-name">Bernabeu Realty</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="agency-contact">TelÃ©fono: 654 34 32 32</div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="agency-assessor">Asesor: <strong>VÃ­ctor PÃ©rez</strong></div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="agency-services-wrapper">
Â  Â  Â  Â  Â  Â  Â  <div class="card-subtitle" style="margin-top:-0.5rem; margin-bottom: 0.5rem; font-weight: 600;">Servicios Activos:</div>
Â  Â  Â  Â  Â  Â  Â  <div class="agency-services-list" id="agencyActiveServices">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <button type="button" class="btn-campana-firmada">
Â  Â  Â  Â  Â  Â  Â  <span style="color:white; margin-right: 5px;">âœ…</span> CampaÃ±a Firmada
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </article>

Â  Â  Â  Â  <article class="card">
Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  <div class="card-header-main">
Â  Â  Â  Â  Â  Â  Â  <div class="card-title">HistÃ³rico de Acciones</div>
Â  Â  Â  Â  Â  Â  Â  <div class="card-subtitle">
Â  Â  Â  Â  Â  Â  Â  Â  Cambios, subidas y autorizaciones recientes.
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <button type="button" class="notification-pill" id="btnNotif" style="background-color: var(--bg-card-alt); border-color: var(--accent-soft);">
Â  Â  Â  Â  Â  Â  Â  <span class="dot" style="background-color: var(--accent);"></span> Ver Log
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="recent-list" id="recentList"></div>
Â  Â  Â  Â  Â  <div class="card-subtitle" style="margin-top: 0.5rem; text-align: center;">
Â  Â  Â  Â  Â  Â  <a href="#" style="color: var(--accent);">Auditar todas las acciones &rarr;</a>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </article>
Â  Â  Â  </section>

Â  Â  Â  Â  Â  Â  <section class="grid">
Â  Â  Â  Â  <article class="card">
Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  <div class="card-header-main">
Â  Â  Â  Â  Â  Â  Â  <div class="card-title">Subir fotos y documentaciÃ³n</div>
Â  Â  Â  Â  Â  Â  Â  <div class="card-subtitle">
Â  Â  Â  Â  Â  Â  Â  Â  Gestiona todas las fotos HD, planos y escrituras desde aquÃ­.
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="upload-grid">
Â  Â  Â  Â  Â  Â  <div class="upload-card">
Â  Â  Â  Â  Â  Â  Â  <div class="upload-title">Subir fotos de la vivienda</div>
Â  Â  Â  Â  Â  Â  Â  <div
Â  Â  Â  Â  Â  Â  Â  Â  class="dropzone"
Â  Â  Â  Â  Â  Â  Â  Â  id="dropFotos"
Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Arrastra las fotos aquÃ­ o haz clic para seleccionar.
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <input
Â  Â  Â  Â  Â  Â  Â  Â  type="file"
Â  Â  Â  Â  Â  Â  Â  Â  id="fileFotos"
Â  Â  Â  Â  Â  Â  Â  Â  accept="image/*"
Â  Â  Â  Â  Â  Â  Â  Â  multiple
Â  Â  Â  Â  Â  Â  Â  Â  style="display: none;"
Â  Â  Â  Â  Â  Â  Â  />
Â  Â  Â  Â  Â  Â  Â  <div class="upload-progress">
Â  Â  Â  Â  Â  Â  Â  Â  <div
Â  Â  Â  Â  Â  Â  Â  Â  Â  class="upload-progress-bar"
Â  Â  Â  Â  Â  Â  Â  Â  Â  id="progressFotos"
Â  Â  Â  Â  Â  Â  Â  Â  ></div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <div class="upload-actions-row">
Â  Â  Â  Â  Â  Â  Â  Â  <button
Â  Â  Â  Â  Â  Â  Â  Â  Â  type="button"
Â  Â  Â  Â  Â  Â  Â  Â  Â  class="btn-upload"
Â  Â  Â  Â  Â  Â  Â  Â  Â  id="btnSubirFotos"
Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Subir / arrastrar fotos
Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  <button
Â  Â  Â  Â  Â  Â  Â  Â  Â  type="button"
Â  Â  Â  Â  Â  Â  Â  Â  Â  class="btn-upload secondary"
Â  Â  Â  Â  Â  Â  Â  Â  Â  id="btnVerFotos"
Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Ver fotos subidas
Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <div class="upload-meta" id="metaFotos"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="upload-card">
Â  Â  Â  Â  Â  Â  Â  <div class="upload-title">Subir documentaciÃ³n</div>
Â  Â  Â  Â  Â  Â  Â  <div
Â  Â  Â  Â  Â  Â  Â  Â  class="dropzone"
Â  Â  Â  Â  Â  Â  Â  Â  id="dropDocs"
Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Arrastra documentaciÃ³n (PDF, escriturasâ€¦) o haz clic.
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <input
Â  Â  Â  Â  Â  Â  Â  Â  type="file"
Â  Â  Â  Â  Â  Â  Â  Â  id="fileDocs"
Â  Â  Â  Â  Â  Â  Â  Â  multiple
Â  Â  Â  Â  Â  Â  Â  Â  style="display: none;"
Â  Â  Â  Â  Â  Â  Â  />
Â  Â  Â  Â  Â  Â  Â  <div class="upload-progress">
Â  Â  Â  Â  Â  Â  Â  Â  <div
Â  Â  Â  Â  Â  Â  Â  Â  Â  class="upload-progress-bar"
Â  Â  Â  Â  Â  Â  Â  Â  Â  id="progressDocs"
Â  Â  Â  Â  Â  Â  Â  Â  ></div>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <div class="upload-actions-row">
Â  Â  Â  Â  Â  Â  Â  Â  <button
Â  Â  Â  Â  Â  Â  Â  Â  Â  type="button"
Â  Â  Â  Â  Â  Â  Â  Â  Â  class="btn-upload"
Â  Â  Â  Â  Â  Â  Â  Â  Â  id="btnSubirDocs"
Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Subir / arrastrar documentaciÃ³n
Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  Â  <button
Â  Â  Â  Â  Â  Â  Â  Â  Â  type="button"
Â  Â  Â  Â  Â  Â  Â  Â  Â  class="btn-upload secondary"
Â  Â  Â  Â  Â  Â  Â  Â  Â  id="btnVerDocs"
Â  Â  Â  Â  Â  Â  Â  Â  >
Â  Â  Â  Â  Â  Â  Â  Â  Â  Ver documentaciÃ³n subida
Â  Â  Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <div class="upload-meta" id="metaDocs"></div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </article>

Â  Â  Â  Â  <article class="card">
Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  <div class="card-header-main">
Â  Â  Â  Â  Â  Â  Â  <div class="card-title">
Â  Â  Â  Â  Â  Â  Â  Â  Servicios disponibles (tarifas ejemplo)
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <div class="card-subtitle">
Â  Â  Â  Â  Â  Â  Â  Â  Activa solo lo que tenga sentido para tu campaÃ±a.
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <button type="button" class="services-link" id="btnVerServicios">
Â  Â  Â  Â  Â  Â  Â  Ver todos los servicios
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="services-grid" id="servicesGrid"></div>

Â  Â  Â  Â  Â  <p class="card-subtitle" style="margin-top: 0.7rem;">
Â  Â  Â  Â  Â  Â  El propietario ve esto como â€œpanel de mandoâ€: quÃ© estÃ¡ activo, quÃ©
Â  Â  Â  Â  Â  Â  falta por activar y quÃ© servicios ya han sido realizados.
Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  </article>
Â  Â  Â  </section>

Â  Â  Â  <section class="grid-1">
Â  Â  Â  Â  <article class="card">
Â  Â  Â  Â  Â  <div class="card-header">
Â  Â  Â  Â  Â  Â  <div class="card-header-main">
Â  Â  Â  Â  Â  Â  Â  <div class="card-title">
Â  Â  Â  Â  Â  Â  Â  Â  Agencias interesadas en gestiÃ³n de campaÃ±a de venta
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  <div class="card-subtitle">
Â  Â  Â  Â  Â  Â  Â  Â  Cuando autorices, la agencia recibirÃ¡ tus datos de contacto para
Â  Â  Â  Â  Â  Â  Â  Â  llamarte cuanto antes.
Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="agencies-list" id="agenciesList">
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  <div class="agency-caption">
Â  Â  Â  Â  Â  Â  Al confirmar, compartiremos tu telÃ©fono, correo y WhatsApp con la
Â  Â  Â  Â  Â  Â  agencia autorizada para que te contacte lo antes posible.
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </article>
Â  Â  Â  </section>
Â  Â  </main>
Â  </div>

Â  <div class="modal-backdrop" id="uploadsModal">
Â  Â  <div class="modal">
Â  Â  Â  <div class="modal-header">
Â  Â  Â  Â  <div class="modal-title" id="modalTitle">Archivos subidos</div>
Â  Â  Â  Â  <button class="modal-close" id="modalClose">âœ•</button>
Â  Â  Â  </div>
Â  Â  Â  <div class="modal-body" id="modalBody"></div>
Â  Â  </div>
Â  </div>

Â  <div class="image-viewer-backdrop" id="imageViewer">
Â  Â  <div class="image-viewer-inner">
Â  Â  Â  <button class="image-viewer-close" id="imageViewerClose">âœ•</button>
Â  Â  Â  <img src="" alt="Vista previa" id="imageViewerImg" />
Â  Â  </div>
Â  </div>

Â  <script>
Â  Â  /* ============================
Â  Â  	CONSTANTES DE STORAGE
Â  Â  	============================ */

Â  Â  const STORAGE_SERVICIOS = "panamoveServicios";
Â  Â  const STORAGE_UPLOADS = "panamoveUploads";
Â  Â  const STORAGE_LOG = "panamoveLog";
Â  Â Â 
Â  Â  const UPLOAD_DELAY = 10;Â 

Â  Â  /* ============================
Â  Â  	UTILIDAD: LOG DE ACCIONES
Â  Â  	============================ */

Â  Â  function loadLog() {
Â  Â  Â  try {
Â  Â  Â  Â  const raw = localStorage.getItem(STORAGE_LOG);
Â  Â  Â  Â  return raw ? JSON.parse(raw) : [];
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  return [];
Â  Â  Â  }
Â  Â  }

Â  Â  function saveLog(list) {
Â  Â  Â  try {
Â  Â  Â  Â  localStorage.setItem(STORAGE_LOG, JSON.stringify(list));
Â  Â  Â  } catch (e) {}
Â  Â  }

Â  Â  function addLogEntry(text) {
Â  Â  Â  const now = new Date();
Â  Â  Â  const dateStr = now.toISOString().slice(0, 10); // YYYY-MM-DD
Â  Â  Â  const timeStr = now.toTimeString().slice(0, 8); // HH:MM:SS

Â  Â  Â  const list = loadLog();
Â  Â  Â  list.unshift({
Â  Â  Â  Â  time: timeStr,
Â  Â  Â  Â  date: dateStr,
Â  Â  Â  Â  text,
Â  Â  Â  });

Â  Â  Â  // Limitar a 200 entradas
Â  Â  Â  if (list.length > 200) list.length = 200;
Â  Â  Â  saveLog(list);
Â  Â  Â  renderLog();
Â  Â  }

Â  Â  function renderLog() {
Â  Â  Â  const list = loadLog();
Â  Â  Â  const container = document.getElementById("recentList");
Â  Â  Â  if (!container) return;

Â  Â  Â  container.innerHTML = "";

Â  Â  Â  if (!list.length) {
Â  Â  Â  Â  const p = document.createElement("p");
Â  Â  Â  Â  p.className = "card-subtitle";
Â  Â  Â  Â  p.textContent =
Â  Â  Â  Â  Â  "AquÃ­ aparecerÃ¡n los servicios activados, documentos subidos y agencias autorizadas.";
Â  Â  Â  Â  container.appendChild(p);
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  list.forEach((item) => {
Â  Â  Â  Â  const row = document.createElement("div");
Â  Â  Â  Â  row.className = "recent-item";

Â  Â  Â  Â  const time = document.createElement("div");
Â  Â  Â  Â  time.className = "recent-time";
Â  Â  Â  Â  time.textContent = `[${item.time} Â· ${item.date}]`;

Â  Â  Â  Â  const text = document.createElement("div");
Â  Â  Â  Â  text.className = "recent-text";
Â  Â  Â  Â  text.textContent = item.text;

Â  Â  Â  Â  row.appendChild(time);
Â  Â  Â  Â  row.appendChild(text);
Â  Â  Â  Â  container.appendChild(row);
Â  Â  Â  });
Â  Â  }

Â  Â  /* ============================
Â  Â  	PRECIO / SIMULACIÃ“N
Â  Â  	============================ */

Â  Â  function formatMoney(num) {
Â  Â  Â  return num.toLocaleString("es-ES", {
Â  Â  Â  Â  minimumFractionDigits: 0,
Â  Â  Â  Â  maximumFractionDigits: 0,
Â  Â  Â  });
Â  Â  }

Â  Â  // LÃ³gica de precios actualizada para incluir costes de servicios.
Â  Â  function recalcPrice() {
Â  Â  Â  const input = document.getElementById("precioInput");
Â  Â  Â  const lines = document.getElementById("priceLines");
Â  Â  Â  if (!input || !lines) return;

Â  Â  Â  const base = Number(input.value || 0);

Â  Â  Â  const serviciosActivos = loadServiciosEstado().filter(svc => svc.activo);
Â  Â  Â  const costeServiciosFijos = serviciosActivos.reduce((sum, svc) => sum + (svc.costeFijo || 0), 0);
Â  Â  Â Â 
Â  Â  Â  const comisionBase = base * 0.03;
Â  Â  Â  const comisionTotal = comisionBase + costeServiciosFijos;Â 
Â  Â  Â Â 
Â  Â  Â  const ivaServicios = comisionTotal * 0.21;
Â  Â  Â  const totalServicios = comisionTotal + ivaServicios;
Â  Â  Â Â 
Â  Â  Â  const neto = base - comisionTotal;

Â  Â  Â  lines.innerHTML = `
Â  Â  Â  Â  IVA servicios 21 %: ${formatMoney(ivaServicios)} â‚¬<br />
Â  Â  Â  Â  ComisiÃ³n 3 % gestiÃ³n + Coste servicios fijos: ${formatMoney(comisionTotal)} â‚¬<br />
Â  Â  Â  Â  <span class="total">Total a pagar (servicios + comisiÃ³n + IVA): ${formatMoney(
Â  Â  Â  Â  Â  totalServicios
Â  Â  Â  Â  )} â‚¬</span><br /><br />
Â  Â  Â  Â  Neto para ti (antes de plusvalÃ­a): ${formatMoney(neto)} â‚¬
Â  Â  Â  `;
Â  Â  }


Â  Â  /* ============================
Â  Â  	SERVICIOS (4 EN DASHBOARD)
Â  Â  	============================ */

Â  Â  // CORRECCIÃ“N: Se aÃ±ade 'costeFijo' a cada servicio.
Â  Â  const serviciosDashboardBase = [
Â  Â  Â  { id: "fotos", nombre: "Fotos PRO", categoria: "Imagen", precio: "450 â‚¬ Â· pago a Ã©xito", costeFijo: 450, descripcion: "FotÃ³grafo especializado inmobiliario.", activoPorDefecto: true },
Â  Â  Â  { id: "video-dron", nombre: "VÃ­deo + dron", categoria: "VÃ­deo", precio: "450 â‚¬ Â· pago a Ã©xito", costeFijo: 450, descripcion: "Recorrido interior + vistas aÃ©reas.", activoPorDefecto: true },
Â  Â  Â  { id: "home-staging", nombre: "Home staging", categoria: "EstÃ©tica", precio: "750â€“1200 â‚¬ Â· pago a Ã©xito", costeFijo: 750, descripcion: "Mejora estÃ©tica sin reformas pesadas.", activoPorDefecto: true },
Â  Â  Â  { id: "blogger-internacional", nombre: "Blogger internacional", categoria: "DifusiÃ³n", precio: "3000 â‚¬ Â· pago a Ã©xito", costeFijo: 3000, descripcion: "Historia real de la vivienda en otro paÃ­s.", activoPorDefecto: false },
Â  Â  ];

Â  Â  function loadServiciosEstado() {
Â  Â  Â  try {
Â  Â  Â  Â  const raw = localStorage.getItem(STORAGE_SERVICIOS);
Â  Â  Â  Â  const stored = raw ? JSON.parse(raw) : [];
Â  Â  Â  Â  const map = new Map(stored.map((s) => [s.id, s.activo]));
Â  Â  Â  Â  return serviciosDashboardBase.map((svc) => ({
Â  Â  Â  Â  Â  ...svc,
Â  Â  Â  Â  Â  activo: map.has(svc.id)
Â  Â  Â  Â  Â  Â  ? !!map.get(svc.id)
Â  Â  Â  Â  Â  Â  : svc.id === "fotos" || svc.id === "home-staging" // Activos por defecto si no hay nada en storage
Â  Â  Â  Â  }));
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  return serviciosDashboardBase.map((svc) => ({
Â  Â  Â  Â  Â  ...svc,
Â  Â  Â  Â  Â  activo: svc.id === "fotos" || svc.id === "home-staging",
Â  Â  Â  Â  }));
Â  Â  Â  }
Â  Â  }

Â  Â  let serviciosEstado = loadServiciosEstado();

Â  Â  function saveServiciosEstado() {
Â  Â  Â  try {
Â  Â  Â  Â  const raw = localStorage.getItem(STORAGE_SERVICIOS);
Â  Â  Â  Â  const stored = raw ? JSON.parse(raw) : [];
Â  Â  Â  Â  const map = new Map(stored.map((s) => [s.id, s]));
Â  Â  Â  Â  serviciosEstado.forEach((svc) => {
Â  Â  Â  Â  Â  map.set(svc.id, { id: svc.id, activo: !!svc.activo, costeFijo: svc.costeFijo });
Â  Â  Â  Â  });
Â  Â  Â  Â  const arr = Array.from(map.values());
Â  Â  Â  Â  localStorage.setItem(STORAGE_SERVICIOS, JSON.stringify(arr));
Â  Â  Â  } catch (e) {}
Â  Â  }

Â  Â  function toggleServicioDashboard(id) {
Â  Â  Â  serviciosEstado = serviciosEstado.map((svc) =>
Â  Â  Â  Â  svc.id === id ? { ...svc, activo: !svc.activo } : svc
Â  Â  Â  );
Â  Â  Â  saveServiciosEstado();
Â  Â  Â  const svc = serviciosEstado.find((s) => s.id === id);
Â  Â  Â  if (svc) {
Â  Â  Â  Â  addLogEntry(
Â  Â  Â  Â  Â  `${svc.activo ? "Servicio activado" : "Servicio desactivado"}: ${
Â  Â  Â  Â  Â  Â  svc.nombre
Â  Â  Â  Â  Â  }.`
Â  Â  Â  Â  );
Â  Â  Â  }
Â  Â  Â  renderServiciosDashboard();
Â  Â  Â  renderAgencyActiveServices(); // Actualiza los pills de la agencia
Â  Â  Â  recalcPrice();
Â  Â  }
Â  Â  
Â  Â  // FunciÃ³n para renderizar los servicios activos DENTRO del Panel de Agencia
Â  Â  function renderAgencyActiveServices() {
Â  Â  Â  const container = document.getElementById("agencyActiveServices");
Â  Â  Â  if (!container) return;
Â  Â  Â  
Â  Â  Â  container.innerHTML = '';
Â  Â  Â  
Â  Â  Â  const activos = serviciosEstado.filter(svc => svc.activo);
Â  Â  Â  
Â  Â  Â  if (activos.length === 0) {
Â  Â  Â  Â  container.innerHTML = `<p class="card-subtitle" style="margin: 0; padding-top: 5px;">NingÃºn servicio de marketing activo en este momento.</p>`;
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  
Â  Â  Â  activos.forEach(svc => {
Â  Â  Â  Â  const pill = document.createElement('div');
Â  Â  Â  Â  pill.className = 'agency-service-pill';
Â  Â  Â  Â  // Los pills de la agencia tienen un dot verde
Â  Â  Â  Â  pill.innerHTML = `<span class="dot"></span> ${svc.nombre} activado por el propietario`; 
Â  Â  Â  Â  container.appendChild(pill);
Â  Â  Â  });
Â  Â  }


Â  Â  function renderServiciosDashboard() {
Â  Â  Â  const grid = document.getElementById("servicesGrid");
Â  Â  Â  if (!grid) return;

Â  Â  Â  grid.innerHTML = "";

Â  Â  Â  serviciosEstado.forEach((svc) => {
Â  Â  Â  Â  const card = document.createElement("article");
Â  Â  Â  Â  card.className = "service-card" + (svc.activo ? " service-card-active" : "");
Â  Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  Â  <div class="service-card-header">
Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  <div class="service-name">${svc.nombre}</div>
Â  Â  Â  Â  Â  Â  Â  <div class="service-price" style="color: ${svc.activo ? 'var(--gold)' : 'var(--text-soft)'}; margin-top:0;">${svc.precio}</div>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  <div class="service-tag">${svc.categoria}</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <p class="service-desc">${svc.descripcion}</p>
Â  Â  Â  Â  Â  <div class="service-footer">
Â  Â  Â  Â  Â  Â  <span class="service-state-pill ${svc.activo ? '' : 'inactive'}" style="
Â  Â  Â  Â  Â  Â  Â  border-color: ${svc.activo ? 'var(--gold)' : 'var(--border-subtle)'};
Â  Â  Â  Â  Â  Â  Â  color: ${svc.activo ? 'var(--gold)' : 'var(--text-soft)'};
Â  Â  Â  Â  Â  Â  Â  background: ${svc.activo ? 'rgba(251, 191, 36, 0.1)' : 'var(--bg-main)'};
Â  Â  Â  Â  Â  Â  ">
Â  Â  Â  Â  Â  Â  Â  <span class="icon">â˜…</span> 
Â  Â  Â  Â  Â  Â  Â  <span>${svc.activo ? "Servicio activado" : "Pendiente de activar"}</span>
Â  Â  Â  Â  Â  Â  </span>
Â  Â  Â  Â  Â  Â  <button class="btn-ghost" data-id="${svc.id}" style="
Â  Â  Â  Â  Â  Â  Â  border-color: ${svc.activo ? 'var(--danger)' : 'var(--success)'}; 
Â  Â  Â  Â  Â  Â  Â  color: ${svc.activo ? 'var(--danger)' : 'var(--success)'}; 
Â  Â  Â  Â  Â  Â  Â  padding: 0.3rem 0.6rem; font-size: 0.75rem; 
Â  Â  Â  Â  Â  Â  Â  background: ${svc.activo ? 'rgba(239, 68, 68, 0.1)' : 'rgba(34, 197, 94, 0.1)'};
Â  Â  Â  Â  Â  Â  ">
Â  Â  Â  Â  Â  Â  Â  ${svc.activo ? "Desactivar" : "Activar"}
Â  Â  Â  Â  Â  Â  </button>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `;
Â  Â  Â  Â  grid.appendChild(card);
Â  Â  Â  });

Â  Â  Â  grid.querySelectorAll("button").forEach((btn) => {
Â  Â  Â  Â  btn.addEventListener("click", () => {
Â  Â  Â  Â  Â  const id = btn.getAttribute("data-id");
Â  Â  Â  Â  Â  toggleServicioDashboard(id);
Â  Â  Â  Â  });
Â  Â  Â  });
Â  Â  }

Â  Â  function toggleServicioDashboard(id) {
Â  Â  Â  serviciosEstado = serviciosEstado.map((svc) =>
Â  Â  Â  Â  svc.id === id ? { ...svc, activo: !svc.activo } : svc
Â  Â  Â  );
Â  Â  Â  saveServiciosEstado();
Â  Â  Â  const svc = serviciosEstado.find((s) => s.id === id);
Â  Â  Â  if (svc) {
Â  Â  Â  Â  addLogEntry(
Â  Â  Â  Â  Â  `${svc.activo ? "Servicio activado" : "Servicio desactivado"}: ${
Â  Â  Â  Â  Â  Â  svc.nombre
Â  Â  Â  Â  Â  }.`
Â  Â  Â  Â  );
Â  Â  Â  }
Â  Â  Â  renderServiciosDashboard();
Â  Â  Â  renderAgencyActiveServices(); // Actualiza los pills de la agencia
Â  Â  Â  recalcPrice();
Â  Â  }

Â  Â  /* ============================
Â  Â  	AGENCIAS
Â  Â  	============================ */

Â  Â  const agenciesData = [
Â  Â  Â  {
Â  Â  Â  Â  id: "bernabeu",
Â  Â  Â  Â  siglas: "BR",
Â  Â  Â  Â  nombre: "Bernabeu Realty",
Â  Â  Â  Â  telefono: "654 34 32 32",
Â  Â  Â  Â  texto: "Dispuesta a asumir los gastos clave para acelerar la venta.",
Â  Â  Â  },
Â  Â  Â  {
Â  Â  Â  Â  id: "roth",
Â  Â  Â  Â  siglas: "RT",
Â  Â  Â  Â  nombre: "RT Rothchild Inmo",
Â  Â  Â  Â  telefono: "654 34 32 32",
Â  Â  Â  Â  texto:
Â  Â  Â  Â  Â  "Dispuesta a asumir los gastos clave para acelerar la venta.",
Â  Â  Â  },
Â  Â  ];

Â  Â  function loadAgenciesState() {
Â  Â  Â  try {
Â  Â  Â  Â  const raw = localStorage.getItem("panamoveAgencias");
Â  Â  Â  Â  const stored = raw ? JSON.parse(raw) : {};
Â  Â  Â  Â  return agenciesData.map((a) => ({
Â  Â  Â  Â  Â  ...a,
Â  Â  Â  Â  Â  autorizado: !!stored[a.id],
Â  Â  Â  Â  }));
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  return agenciesData.map((a) => ({ ...a, autorizado: false }));
Â  Â  Â  }
Â  Â  }

Â  Â  let agenciesState = loadAgenciesState();

Â  Â  function saveAgenciesState() {
Â  Â  Â  try {
Â  Â  Â  Â  const map = {};
Â  Â  Â  Â  agenciesState.forEach((a) => {
Â  Â  Â  Â  Â  map[a.id] = !!a.autorizado;
Â  Â  Â  Â  });
Â  Â  Â  Â  localStorage.setItem("panamoveAgencias", JSON.stringify(map));
Â  Â  Â  } catch (e) {}
Â  Â  }

Â  Â  function renderAgencies() {
Â  Â  Â  const container = document.getElementById("agenciesList");
Â  Â  Â  if (!container) return;
Â  Â  Â  container.innerHTML = "";

Â  Â  Â  agenciesState.forEach((ag) => {
Â  Â  Â  Â  const row = document.createElement("div");
Â  Â  Â  Â  row.className = "agency-row";

Â  Â  Â  Â  const main = document.createElement("div");
Â  Â  Â  Â  main.className = "agency-main";

Â  Â  Â  Â  const avatar = document.createElement("div");
Â  Â  Â  Â  avatar.className = "agency-avatar";
Â  Â  Â  Â  avatar.textContent = ag.siglas;

Â  Â  Â  Â  const text = document.createElement("div");
Â  Â  Â  Â  const name = document.createElement("div");
Â  Â  Â  Â  name.className = "agency-name";
Â  Â  Â  Â  name.textContent = ag.nombre;
Â  Â  Â  Â  const phone = document.createElement("div");
Â  Â  Â  Â  phone.className = "agency-phone";
Â  Â  Â  Â  phone.textContent = `TelÃ©fono: ${ag.telefono}`;
Â  Â  Â  Â  const caption = document.createElement("div");
Â  Â  Â  Â  caption.className = "agency-phone";
Â  Â  Â  Â  caption.textContent = ag.texto;

Â  Â  Â  Â  text.appendChild(name);
Â  Â  Â  Â  text.appendChild(phone);
Â  Â  Â  Â  text.appendChild(caption);

Â  Â  Â  Â  main.appendChild(avatar);
Â  Â  Â  Â  main.appendChild(text);

Â  Â  Â  Â  const btn = document.createElement("button");
Â  Â  Â  Â  btn.className =
Â  Â  Â  Â  Â  "agency-btn" + (ag.autorizado ? " agency-btn-confirmed" : "");
Â  Â  Â  Â  btn.innerHTML = `${
Â  Â  Â  Â  Â  ag.autorizado ? "âœ… Datos enviados" : "âœ… Autorizar"
Â  Â  Â  Â  }`;
Â  Â  Â  Â  btn.addEventListener("click", () => {
Â  Â  Â  Â  Â  ag.autorizado = !ag.autorizado;
Â  Â  Â  Â  Â  saveAgenciesState();
Â  Â  Â  Â  Â  addLogEntry(
Â  Â  Â  Â  Â  Â  ag.autorizado
Â  Â  Â  Â  Â  Â  Â  ? `Has autorizado a ${ag.nombre} para gestionar la campaÃ±a y recibir tus datos de contacto.`
Â  Â  Â  Â  Â  Â  Â  : `Has revocado la autorizaciÃ³n a ${ag.nombre} en la campaÃ±a.`
Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  renderAgencies();
Â  Â  Â  Â  });

Â  Â  Â  Â  row.appendChild(main);
Â  Â  Â  Â  row.appendChild(btn);
Â  Â  Â  Â  container.appendChild(row);
Â  Â  Â  });
Â  Â  }

Â  Â  /* ============================
Â  Â  	UPLOADS + MODAL
Â  Â  	============================ */

Â  Â  function loadUploads() {
Â  Â  Â  try {
Â  Â  Â  Â  const raw = localStorage.getItem(STORAGE_UPLOADS);
Â  Â  Â  Â  const parsed = raw ? JSON.parse(raw) : {};
Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  fotos: Array.isArray(parsed.fotos) ? parsed.fotos : [],
Â  Â  Â  Â  Â  docs: Array.isArray(parsed.docs) ? parsed.docs : [],
Â  Â  Â  Â  };
Â  Â  Â  } catch (e) {
Â  Â  Â  Â  return { fotos: [], docs: [] };
Â  Â  Â  }
Â  Â  }

Â  Â  function saveUploads(data) {
Â  Â  Â  try {
Â  Â  Â  Â  localStorage.setItem(STORAGE_UPLOADS, JSON.stringify(data));
Â  Â  Â  } catch (e) {}
Â  Â  }

Â  Â  let uploads = loadUploads();

Â  Â  function updateUploadMeta() {
Â  Â  Â  const metaFotos = document.getElementById("metaFotos");
Â  Â  Â  const metaDocs = document.getElementById("metaDocs");
Â  Â  Â Â 
Â  Â  Â  const fotosCount = uploads.fotos.length;
Â  Â  Â  const docsCount = uploads.docs.length;

Â  Â  Â  if (metaFotos) {
Â  Â  Â  Â  metaFotos.textContent =
Â  Â  Â  Â  Â  fotosCount === 0
Â  Â  Â  Â  Â  Â  ? "No hay fotos subidas todavÃ­a."
Â  Â  Â  Â  Â  Â  : `${fotosCount} foto(s) guardadas en el sistema.`;
Â  Â  Â  }
Â  Â  Â  if (metaDocs) {
Â  Â  Â  Â  metaDocs.textContent =
Â  Â  Â  Â  Â  docsCount === 0
Â  Â  Â  Â  Â  Â  ? "No hay documentos subidos todavÃ­a."
Â  Â  Â  Â  Â  Â  : `${docsCount} documento(s) guardados en el sistema.`;
Â  Â  Â  }
Â  Â  }

Â  Â  function handleFiles(list, tipo) {
Â  Â  Â  if (!list || !list.length) return;
Â  Â  Â Â 
Â  Â  Â  const progressBar =
Â  Â  Â  Â  tipo === "fotos"
Â  Â  Â  Â  Â  ? document.getElementById("progressFotos")
Â  Â  Â  Â  Â  : document.getElementById("progressDocs");
Â  Â  Â  const metaElement =Â 
Â  Â  Â  Â  tipo === "fotos"
Â  Â  Â  Â  Â  ? document.getElementById("metaFotos")
Â  Â  Â  Â  Â  : document.getElementById("metaDocs");
Â  Â  Â  Â  Â Â 
Â  Â  Â  if (progressBar) progressBar.style.width = "0%";
Â  Â  Â Â 
Â  Â  Â  const filesArray = Array.from(list);
Â  Â  Â  let filesProcessed = 0;

Â  Â  Â  const processFile = (file) => {
Â  Â  Â  Â  Â  return new Promise(resolve => {
Â  Â  Â  Â  Â  Â  Â  const reader = new FileReader();
Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  reader.onload = (ev) => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  const dataUrl = ev.target.result;
Â  Â  Â  Â  Â  Â  Â  Â  Â  const item = {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  name: file.name,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  dataUrl,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  type: file.type // Guardar el tipo MIME para el futuro
Â  Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  Â  Â  Â  if (tipo === "fotos") uploads.fotos.push(item);
Â  Â  Â  Â  Â  Â  Â  Â  Â  else uploads.docs.push(item);
Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  filesProcessed++;
Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  const percent = Math.round((filesProcessed / filesArray.length) * 100);
Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  if (progressBar) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  progressBar.style.width = percent + "%";
Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  if (metaElement) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  metaElement.textContent = `Subiendo: ${percent}% completado (${filesProcessed}/${filesArray.length} archivos)`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  Â  // Simular tiempo de subida
Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => resolve(), UPLOAD_DELAY);Â 
Â  Â  Â  Â  Â  Â  Â  };

Â  Â  Â  Â  Â  Â  Â  // Empezar la lectura del archivo
Â  Â  Â  Â  Â  Â  Â  reader.readAsDataURL(file);Â 
Â  Â  Â  Â  Â  });
Â  Â  Â  };
Â  Â  Â Â 
Â  Â  Â  // Encadenar las promesas para subirlos uno por uno (simulaciÃ³n secuencial)
Â  Â  Â  filesArray.reduce((p, file) => p.then(() => processFile(file)), Promise.resolve())
Â  Â  Â  Â  Â  .then(() => {
Â  Â  Â  Â  Â  Â  Â  // Una vez que todos los archivos han sido procesados
Â  Â  Â  Â  Â  Â  Â  saveUploads(uploads);
Â  Â  Â  Â  Â  Â  Â  updateUploadMeta();
Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  if (metaElement) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  metaElement.textContent = `${filesArray.length} archivo(s) subidos con Ã©xito.`;
Â  Â  Â  Â  Â  Â  Â  Â  Â  // Opcional: limpiar la barra de progreso despuÃ©s de un pequeÃ±o retraso
Â  Â  Â  Â  Â  Â  Â  Â  Â  setTimeout(() => { if (progressBar) progressBar.style.width = "0%"; }, 2000);Â 
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  addLogEntry(
Â  Â  Â  Â  Â  Â  Â  Â  Â  `Has subido ${filesArray.length} ${
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tipo === "fotos" ? "foto(s)" : "documento(s)"
Â  Â  Â  Â  Â  Â  Â  Â  Â  } al dashboard.`
Â  Â  Â  Â  Â  Â  Â  );
Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  });
Â  Â  }

Â  Â  // --- modal de lista (fotos / docs) ---
Â  Â  const uploadsModal = document.getElementById("uploadsModal");
Â  Â  const modalBody = document.getElementById("modalBody");
Â  Â  const modalTitle = document.getElementById("modalTitle");
Â  Â  const modalClose = document.getElementById("modalClose");

Â  Â  function openModalUploads(tipo) {
Â  Â  Â  if (!uploadsModal || !modalBody) return;
Â  Â  Â  uploadsModal.style.display = "flex";
Â  Â  Â  modalBody.innerHTML = "";

Â  Â  Â  const list = tipo === "fotos" ? uploads.fotos : uploads.docs;
Â  Â  Â  modalTitle.textContent =
Â  Â  Â  Â  tipo === "fotos" ? "Fotos subidas" : "DocumentaciÃ³n subida";

Â  Â  Â  if (!list.length) {
Â  Â  Â  Â  const p = document.createElement("p");
Â  Â  Â  Â  p.className = "card-subtitle";
Â  Â  Â  Â  p.textContent = "No hay archivos subidos todavÃ­a.";
Â  Â  Â  Â  modalBody.appendChild(p);
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  list.forEach((item, idx) => {
Â  Â  Â  Â  const card = document.createElement("div");
Â  Â  Â  Â  card.className = "modal-item";

Â  Â  Â  Â  const openInNew = () => {
Â  Â  Â  Â  Â  if (!item.dataUrl) return;
Â  Â  Â  Â  Â  if (tipo === "fotos") {
Â  Â  Â  Â  Â  Â  openImageViewer(item.dataUrl, item.name);
Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  window.open(item.dataUrl, "_blank");
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  };

Â  Â  Â  Â  if (tipo === "fotos" && item.dataUrl) {
Â  Â  Â  Â  Â  const img = document.createElement("img");
Â  Â  Â  Â  Â  img.src = item.dataUrl;
Â  Â  Â  Â  Â  img.alt = item.name || "Foto subida";
Â  Â  Â  Â  Â  img.addEventListener("click", openInNew);
Â  Â  Â  Â  Â  card.appendChild(img);
Â  Â  Â  Â  }

Â  Â  Â  Â  const name = document.createElement("div");
Â  Â  Â  Â  name.className = "modal-item-name";
Â  Â  Â  Â  name.textContent = item.name || `Archivo ${idx + 1}`;
Â  Â  Â  Â  card.appendChild(name);

Â  Â  Â  Â  const actions = document.createElement("div");
Â  Â  Â  Â  actions.className = "modal-actions-row";

Â  Â  Â  Â  const openBtn = document.createElement("button");
Â  Â  Â  Â  openBtn.className = "modal-open";
Â  Â  Â  Â  openBtn.textContent = "Abrir";
Â  Â  Â  Â  openBtn.addEventListener("click", openInNew);

Â  Â  Â  Â  const delBtn = document.createElement("button");
Â  Â  Â  Â  delBtn.className = "modal-delete";
Â  Â  Â  Â  delBtn.textContent = "Eliminar";
Â  Â  Â  Â  delBtn.addEventListener("click", (ev) => {
Â  Â  Â  Â  Â  ev.stopPropagation();
Â  Â  Â  Â  Â  list.splice(idx, 1);
Â  Â  Â  Â  Â  saveUploads(uploads);
Â  Â  Â  Â  Â  updateUploadMeta();
Â  Â  Â  Â  Â  openModalUploads(tipo);
Â  Â  Â  Â  });

Â  Â  Â  Â  actions.appendChild(openBtn);
Â  Â  Â  Â  actions.appendChild(delBtn);
Â  Â  Â  Â  card.appendChild(actions);

Â  Â  Â  Â  card.addEventListener("click", openInNew);

Â  Â  Â  Â  modalBody.appendChild(card);
Â  Â  Â  });
Â  Â  }

Â  Â  function closeModalUploads() {
Â  Â  Â  if (!uploadsModal) return;
Â  Â  Â  uploadsModal.style.display = "none";
Â  Â  }

Â  Â  if (modalClose) {
Â  Â  Â  modalClose.addEventListener("click", closeModalUploads);
Â  Â  }
Â  Â  if (uploadsModal) {
Â  Â  Â  uploadsModal.addEventListener("click", (ev) => {
Â  Â  Â  Â  if (ev.target === uploadsModal) closeModalUploads();
Â  Â  Â  });
Â  Â  }

Â  Â  /* VISOR PRO ----------------------------------------------------------- */
Â  Â  const imageViewer = document.getElementById("imageViewer");
Â  Â  const imageViewerImg = document.getElementById("imageViewerImg");
Â  Â  const imageViewerClose = document.getElementById("imageViewerClose");

Â  Â  function openImageViewer(url, name) {
Â  Â  Â  if (!url || !imageViewer || !imageViewerImg) return;
Â  Â  Â  imageViewerImg.src = url;
Â  Â  Â  imageViewerImg.alt = name || "Foto subida";
Â  Â  Â  imageViewer.style.display = "flex";
Â  Â  }

Â  Â  function closeImageViewer() {
Â  Â  Â  if (!imageViewer || !imageViewerImg) return;
Â  Â  Â  imageViewer.style.display = "none";
Â  Â  Â  imageViewerImg.src = "";
Â  Â  }

Â  Â  if (imageViewerClose) {
Â  Â  Â  imageViewerClose.addEventListener("click", closeImageViewer);
Â  Â  }
Â  Â  if (imageViewer) {
Â  Â  Â  imageViewer.addEventListener("click", (ev) => {
Â  Â  Â  Â  if (ev.target === imageViewer) closeImageViewer();
Â  Â  Â  });
Â  Â  }
Â  Â  document.addEventListener("keydown", (ev) => {
Â  Â  Â  if (ev.key === "Escape") {
Â  Â  Â  Â  closeImageViewer();
Â  Â  Â  Â  closeModalUploads();
Â  Â  Â  }
Â  Â  });

Â  Â  /* ============================
Â  Â  Â  INICIALIZACIÃ“N & EVENTOS
Â  Â  Â  ============================ */

Â  Â  document.addEventListener("DOMContentLoaded", () => {
Â  Â  Â  // precio
Â  Â  Â  recalcPrice();
Â  Â  Â  const precioInput = document.getElementById("precioInput");
Â  Â  Â  if (precioInput) {
Â  Â  Â  Â  precioInput.addEventListener("input", recalcPrice);
Â  Â  Â  Â  precioInput.addEventListener("change", recalcPrice);
Â  Â  Â  Â  precioInput.addEventListener("blur", recalcPrice);
Â  Â  Â  }
Â  Â  Â  const btnSim = document.getElementById("btnSimulacion");
Â  Â  Â  if (btnSim) btnSim.addEventListener("click", recalcPrice);

Â  Â  Â  // servicios
Â  Â  Â  serviciosEstado = loadServiciosEstado();
Â  Â  Â  renderServiciosDashboard();
Â  Â  Â  renderAgencyActiveServices();

Â  Â  Â  const btnVerServicios = document.getElementById("btnVerServicios");
Â  Â  Â  if (btnVerServicios) {
Â  Â  Â  Â  btnVerServicios.addEventListener("click", () => {
Â  Â  Â  Â  Â  window.location.href = "servicios.html";
Â  Â  Â  Â  });
Â  Â  Â  }

Â  Â  Â  agenciesState = loadAgenciesState();
Â  Â  Â  renderAgencies();

Â  Â  Â  uploads = loadUploads();
Â  Â  Â  updateUploadMeta();

Â  Â  Â  const dropFotos = document.getElementById("dropFotos");
Â  Â  Â  const dropDocs = document.getElementById("dropDocs");
Â  Â  Â  const fileFotos = document.getElementById("fileFotos");
Â  Â  Â  const fileDocs = document.getElementById("fileDocs");

Â  Â  Â  if (dropFotos && fileFotos) {
Â  Â  Â  Â  const openPickerFotos = () => fileFotos.click();
Â  Â  Â  Â  const btnSubirFotos = document.getElementById("btnSubirFotos");
Â  Â  Â  Â  if(btnSubirFotos) btnSubirFotos.addEventListener("click", openPickerFotos);
Â  Â  Â  Â Â 
Â  Â  Â  Â  dropFotos.addEventListener("click", openPickerFotos);

Â  Â  Â  Â  ["dragenter", "dragover"].forEach((evName) =>
Â  Â  Â  Â  Â  dropFotos.addEventListener(evName, (ev) => {
Â  Â  Â  Â  Â  Â  ev.preventDefault();
Â  Â  Â  Â  Â  Â  ev.stopPropagation();
Â  Â  Â  Â  Â  Â  dropFotos.classList.add("dragover");
Â  Â  Â  Â  Â  })
Â  Â  Â  Â  );
Â  Â  Â  Â  ["dragleave", "drop"].forEach((evName) =>
Â  Â  Â  Â  Â  dropFotos.addEventListener(evName, (ev) => {
Â  Â  Â  Â  Â  Â  ev.preventDefault();
Â  Â  Â  Â  Â  Â  ev.stopPropagation();
Â  Â  Â  Â  Â  Â  dropFotos.classList.remove("dragover");
Â  Â  Â  Â  Â  })
Â  Â  Â  Â  );
Â  Â  Â  Â  dropFotos.addEventListener("drop", (ev) => {
Â  Â  Â  Â  Â  const files = ev.dataTransfer.files;
Â  Â  Â  Â  Â  handleFiles(files, "fotos");
Â  Â  Â  Â  Â  dropFotos.classList.remove("dragover");
Â  Â  Â  Â  });
Â  Â  Â  Â  fileFotos.addEventListener("change", (ev) => {
Â  Â  Â  Â  Â  handleFiles(ev.target.files, "fotos");
Â  Â  Â  Â  Â  fileFotos.value = "";
Â  Â  Â  Â  });
Â  Â  Â  }

Â  Â  Â  if (dropDocs && fileDocs) {
Â  Â  Â  Â  const openPickerDocs = () => fileDocs.click();
Â  Â  Â  Â  const btnSubirDocs = document.getElementById("btnSubirDocs");
Â  Â  Â  Â  if(btnSubirDocs) btnSubirDocs.addEventListener("click", openPickerDocs);

Â  Â  Â  Â  dropDocs.addEventListener("click", openPickerDocs);

Â  Â  Â  Â  ["dragenter", "dragover"].forEach((evName) =>
Â  Â  Â  Â  Â  dropDocs.addEventListener(evName, (ev) => {
Â  Â  Â  Â  Â  Â  ev.preventDefault();
Â  Â  Â  Â  Â  Â  ev.stopPropagation();
Â  Â  Â  Â  Â  Â  dropDocs.classList.add("dragover");
Â  Â  Â  Â  Â  })
Â  Â  Â  Â  );
Â  Â  Â  Â  ["dragleave", "drop"].forEach((evName) =>
Â  Â  Â  Â  Â  dropDocs.addEventListener(evName, (ev) => {
Â  Â  Â  Â  Â  Â  ev.preventDefault();
Â  Â  Â  Â  Â  Â  ev.stopPropagation();
Â  Â  Â  Â  Â  Â  dropDocs.classList.remove("dragover");
Â  Â  Â  Â  Â  })
Â  Â  Â  Â  );
Â  Â  Â  Â  dropDocs.addEventListener("drop", (ev) => {
Â  Â  Â  Â  Â  const files = ev.dataTransfer.files;
Â  Â  Â  Â  Â  handleFiles(files, "docs");
Â  Â  Â  Â  Â  dropDocs.classList.remove("dragover");
Â  Â  Â  Â  });
Â  Â  Â  Â  fileDocs.addEventListener("change", (ev) => {
Â  Â  Â  Â  Â  handleFiles(ev.target.files, "docs");
Â  Â  Â  Â  Â  fileDocs.value = "";
Â  Â  Â  Â  });
Â  Â  Â  }

Â  Â  Â  const btnVerFotos = document.getElementById("btnVerFotos");
Â  Â  Â  if (btnVerFotos) {
Â  Â  Â  Â  btnVerFotos.addEventListener("click", () => openModalUploads("fotos"));
Â  Â  Â  }
Â  Â  Â  const btnVerDocs = document.getElementById("btnVerDocs");
Â  Â  Â  if (btnVerDocs) {
Â  Â  Â  Â  btnVerDocs.addEventListener("click", () => openModalUploads("docs"));
Â  Â  Â  }

Â  Â  Â  const btnNotif = document.getElementById("btnNotif");
Â  Â  Â  if (btnNotif) {
Â  Â  Â  Â  btnNotif.addEventListener("click", () => {
Â  Â  Â  Â  Â  const recent = document.getElementById("recentList");
Â  Â  Â  Â  Â  if (recent) recent.scrollTop = 0;
Â  Â  Â  Â  });
Â  Â  Â  }

Â  Â  Â  renderLog();
Â  Â  });
Â  </script>
</body>
</html>
